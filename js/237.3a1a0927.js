"use strict";(self["webpackChunkaiArt"]=self["webpackChunkaiArt"]||[]).push([[237],{655:function(e,t,s){var i=s(6955),a=String;e.exports=function(e){if("Symbol"===i(e))throw new TypeError("Cannot convert a Symbol value to a string");return a(e)}},713:function(e,t,s){var i=s(9565),a=s(9306),n=s(8551),o=s(1767),r=s(9462),l=s(6319),c=r((function(){var e=this.iterator,t=n(i(this.next,e)),s=this.done=!!t.done;if(!s)return l(e,this.mapper,[t.value,this.counter++],!0)}));e.exports=function(e){return n(this),a(e),new c(o(this),{mapper:e})}},1701:function(e,t,s){var i=s(6518),a=s(713),n=s(6395);i({target:"Iterator",proto:!0,real:!0,forced:n},{map:a})},2812:function(e){var t=TypeError;e.exports=function(e,s){if(e<s)throw new t("Not enough arguments");return e}},4603:function(e,t,s){var i=s(6840),a=s(9504),n=s(655),o=s(2812),r=URLSearchParams,l=r.prototype,c=a(l.append),d=a(l["delete"]),u=a(l.forEach),p=a([].push),g=new r("a=1&a=2&b=3");g["delete"]("a",1),g["delete"]("b",void 0),g+""!=="a=2"&&i(l,"delete",(function(e){var t=arguments.length,s=t<2?void 0:arguments[1];if(t&&void 0===s)return d(this,e);var i=[];u(this,(function(e,t){p(i,{key:t,value:e})})),o(t,1);var a,r=n(e),l=n(s),g=0,h=0,m=!1,v=i.length;while(g<v)a=i[g++],m||a.key===r?(m=!0,d(this,a.key)):h++;while(h<v)a=i[h++],a.key===r&&a.value===l||c(this,a.key,a.value)}),{enumerable:!0,unsafe:!0})},7566:function(e,t,s){var i=s(6840),a=s(9504),n=s(655),o=s(2812),r=URLSearchParams,l=r.prototype,c=a(l.getAll),d=a(l.has),u=new r("a=1");!u.has("a",2)&&u.has("a",void 0)||i(l,"has",(function(e){var t=arguments.length,s=t<2?void 0:arguments[1];if(t&&void 0===s)return d(this,e);var i=c(this,e);o(t,1);var a=n(s),r=0;while(r<i.length)if(i[r++]===a)return!0;return!1}),{enumerable:!0,unsafe:!0})},7588:function(e,t,s){var i=s(6518),a=s(2652),n=s(9306),o=s(8551),r=s(1767);i({target:"Iterator",proto:!0,real:!0},{forEach:function(e){o(this),n(e);var t=r(this),s=0;a(t,(function(t){e(t,s++)}),{IS_RECORD:!0})}})},8721:function(e,t,s){var i=s(3724),a=s(9504),n=s(2106),o=URLSearchParams.prototype,r=a(o.forEach);i&&!("size"in o)&&n(o,"size",{get:function(){var e=0;return r(this,(function(){e++})),e},configurable:!0,enumerable:!0})},8743:function(e,t,s){s.r(t),s.d(t,{default:function(){return Hi}});var i={};s.r(i),s.d(i,{hasBrowserEnv:function(){return Ge},hasStandardBrowserEnv:function(){return He},hasStandardBrowserWebWorkerEnv:function(){return We},navigator:function(){return qe},origin:function(){return Ke}});var a=function(){var e=this,t=e._self._c;return t("main-layout",[t("div",{staticClass:"create-painting-view"},[t("div",{staticClass:"view-header"},[t("h1",{staticClass:"view-title"},[e._v("AI绘画创作")]),t("div",{staticClass:"user-info"},[e.isLoggedIn?t("div",{staticClass:"user-credits"},[t("span",[e._v("积分: "),t("b",[e._v(e._s(e.userCredits))])]),t("el-button",{attrs:{type:"text",size:"small"},on:{click:e.openBuyCredits}},[e._v("购买积分")])],1):e._e(),e.isLoggedIn?t("div",{staticClass:"user-vip-status"},[e.isVip?[t("el-tag",{attrs:{type:"warning",effect:"dark",size:"medium"}},[e._v("VIP会员")]),t("span",{staticClass:"vip-expires"},[e._v(e._s(e.vipExpiresText))])]:t("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.openVipOptions}},[e._v("开通VIP")])],2):e._e()])]),t("div",{staticClass:"tabs-container"},[t("el-tabs",{staticClass:"painting-tabs",on:{"tab-click":e.handleTabChange},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[t("el-tab-pane",{attrs:{label:"文生图",name:"text2img"}},[t("text-to-image-tab",{ref:"text2imgTab"})],1),t("el-tab-pane",{attrs:{label:"图生图",name:"img2img"}},[t("image-to-image-tab",{ref:"img2imgTab"})],1),t("el-tab-pane",{attrs:{label:"我的图库",name:"gallery"}},[t("gallery-tab",{ref:"galleryTab",on:{changeTab:e.changeTab}})],1),t("el-tab-pane",{attrs:{label:"后期处理",name:"postprocess"}},[t("post-processing-tab",{ref:"postprocessingTab"})],1),t("el-tab-pane",{attrs:{label:"超清放大 (Tiled diffusion)",name:"upscale"}},[t("upscale-tab")],1),t("el-tab-pane",{attrs:{label:"Inpaint Anything",name:"inpaint"}},[t("inpaint-tab")],1),t("el-tab-pane",{attrs:{label:"PNG图片信息",name:"info"}},[t("image-info-tab")],1),t("el-tab-pane",{attrs:{label:"WD1.4 标签器",name:"tagger"}},[t("tagger-tab")],1)],1)],1),e.showFeatureTip?t("div",{staticClass:"feature-tip"},[t("i",{staticClass:"el-icon-info-circle"}),t("span",[e._v("升级到VIP会员可使用更高分辨率和批量生成功能")]),t("el-button",{attrs:{type:"text",size:"small"},on:{click:e.openVipOptions}},[e._v("了解详情")]),t("i",{staticClass:"el-icon-close close-tip",on:{click:e.closeFeatureTip}})],1):e._e(),t("el-dialog",{attrs:{title:"购买积分",visible:e.creditsDialog.visible,width:"40%"},on:{"update:visible":function(t){return e.$set(e.creditsDialog,"visible",t)}}},[t("div",{staticClass:"credit-packages"},e._l(e.creditPackages,(function(s,i){return t("div",{key:i,staticClass:"credit-package",class:{selected:e.creditsDialog.selectedPackage&&e.creditsDialog.selectedPackage.id===s.id},on:{click:function(t){return e.selectCreditPackage(s)}}},[t("div",{staticClass:"package-credits"},[e._v(e._s(s.amount)+"积分")]),t("div",{staticClass:"package-price"},[e._v("¥"+e._s(s.price))]),s.bonus?t("div",{staticClass:"package-info"},[t("el-tag",{attrs:{size:"mini",type:"success"}},[e._v("赠送"+e._s(s.bonus)+"积分")])],1):e._e()])})),0),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.creditsDialog.visible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",disabled:!e.creditsDialog.selectedPackage},on:{click:e.confirmCreditPurchase}},[e._v(" 确认购买 ")])],1)])],1)])},n=[],o=(s(4114),s(5240)),r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"text-to-image-tab"},[t("div",{staticClass:"tab-content"},[t("div",{staticClass:"control-panel"},[t("div",{staticClass:"prompts-section"},[t("div",{staticClass:"prompt-input"},[t("label",[e._v("提示词 Prompt")]),t("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入正向提示词描述你想要的图像内容",resize:"none",maxlength:"1000","show-word-limit":""},model:{value:e.prompts.positive,callback:function(t){e.$set(e.prompts,"positive",t)},expression:"prompts.positive"}}),t("div",{staticClass:"prompt-tips"},[e._v(" 提示：使用详细和具体的描述，提及风格、光线、视角和场景会得到更好的结果 "),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.translatePrompt}},[e._v("翻译为英文")]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.showPromptLibrary}},[e._v("提示词库")])],1)],1),t("div",{staticClass:"negative-prompt"},[t("label",[e._v("负向提示词 Negative Prompt")]),t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入负向提示词描述你不想在图像中出现的元素",resize:"none",maxlength:"500","show-word-limit":""},model:{value:e.prompts.negative,callback:function(t){e.$set(e.prompts,"negative",t)},expression:"prompts.negative"}}),t("div",{staticClass:"prompt-tips"},[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.useDefaultNegativePrompt}},[e._v("使用默认")]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.showNegativeLibrary}},[e._v("负向提示词库")])],1)],1)]),t("div",{staticClass:"settings-section"},[t("div",{staticClass:"model-selection"},[t("div",{staticClass:"model-header-row"},[t("div",{staticClass:"checkpoint-selector"},[t("span",{staticClass:"model-label"},[e._v("基础模型")]),t("div",{staticClass:"selector-container"},[t("el-select",{staticClass:"model-select",attrs:{placeholder:"选择基础模型"},model:{value:e.settings.model,callback:function(t){e.$set(e.settings,"model",t)},expression:"settings.model"}},e._l(e.modelList,(function(s){return t("el-option",{key:s.value,attrs:{label:s.label,value:s.value}},[t("span",[e._v(e._s(s.label))]),t("span",{staticClass:"model-description"},[e._v(e._s(s.description))])])})),1),t("el-button",{staticClass:"refresh-btn",attrs:{type:"primary",icon:"el-icon-refresh",size:"mini",circle:""},on:{click:e.refreshModels}})],1)])]),t("div",{staticClass:"model-header-row"},[t("div",{staticClass:"checkpoint-selector"},[t("span",{staticClass:"model-label"},[e._v("模板")]),t("div",{staticClass:"selector-container"},[t("el-select",{staticClass:"model-select",attrs:{placeholder:"选择模板"},model:{value:e.settings.template,callback:function(t){e.$set(e.settings,"template",t)},expression:"settings.template"}},e._l(e.templateList,(function(s){return t("el-option",{key:s.value,attrs:{label:s.label,value:s.value}},[t("span",[e._v(e._s(s.label))]),t("span",{staticClass:"model-description"},[e._v(e._s(s.description))])])})),1)],1)])]),t("div",{staticClass:"clip-skip"},[t("div",{staticClass:"clip-header"},[t("span",{staticClass:"model-label"},[e._v("CLIP跳过层Clip Skip")]),t("el-tooltip",{attrs:{content:"控制CLIP模型内部使用第几层作为文本特征",placement:"top"}},[t("i",{staticClass:"el-icon-question"})])],1),t("div",{staticClass:"clip-controls"},[t("el-input-number",{staticClass:"clip-input",attrs:{min:1,max:12,step:1,size:"small"},model:{value:e.clipSkipValue,callback:function(t){e.clipSkipValue=t},expression:"clipSkipValue"}}),t("el-switch",{staticClass:"clip-switch",model:{value:e.settings.useClipSkip,callback:function(t){e.$set(e.settings,"useClipSkip",t)},expression:"settings.useClipSkip"}})],1)])]),t("div",{staticClass:"image-settings"},[e._m(0),t("div",{staticClass:"section-content"},[t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("图像尺寸")]),t("div",{staticClass:"setting-control size-inputs"},[t("el-input-number",{attrs:{min:e.settings.painting.limits.minSize,max:e.isVipUser?2048:e.settings.painting.limits.maxSize,step:64,size:"small",placeholder:"宽度"},on:{change:e.updateTokenUsage},model:{value:e.settings.width,callback:function(t){e.$set(e.settings,"width",t)},expression:"settings.width"}}),t("span",{staticClass:"size-separator"},[e._v("×")]),t("el-input-number",{attrs:{min:e.settings.painting.limits.minSize,max:e.isVipUser?2048:e.settings.painting.limits.maxSize,step:64,size:"small",placeholder:"高度"},on:{change:e.updateTokenUsage},model:{value:e.settings.height,callback:function(t){e.$set(e.settings,"height",t)},expression:"settings.height"}}),!e.isVipUser&&(e.settings.width>1024||e.settings.height>1024)?t("el-tooltip",{attrs:{content:"高分辨率需要VIP会员",placement:"top"}},[t("i",{staticClass:"el-icon-warning-outline",staticStyle:{color:"#E6A23C"}})]):e._e()],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("采样器")]),t("div",{staticClass:"setting-control"},[t("el-select",{attrs:{placeholder:"选择采样器",size:"small"},on:{change:e.updateTokenUsage},model:{value:e.settings.sampler,callback:function(t){e.$set(e.settings,"sampler",t)},expression:"settings.sampler"}},e._l(e.samplerList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("步数")]),t("div",{staticClass:"setting-control"},[t("el-slider",{attrs:{min:e.settings.painting.limits.minSteps,max:e.settings.painting.limits.maxSteps,step:1,"show-input":"",size:"small"},on:{change:e.updateTokenUsage},model:{value:e.settings.steps,callback:function(t){e.$set(e.settings,"steps",t)},expression:"settings.steps"}})],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("CFG Scale")]),t("div",{staticClass:"setting-control"},[t("el-slider",{attrs:{min:e.settings.painting.limits.minCfgScale,max:e.settings.painting.limits.maxCfgScale,step:.5,"show-input":"",size:"small"},on:{change:e.updateTokenUsage},model:{value:e.settings.cfgScale,callback:function(t){e.$set(e.settings,"cfgScale",t)},expression:"settings.cfgScale"}})],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("批次大小")]),t("div",{staticClass:"setting-control"},[t("el-input-number",{attrs:{min:e.settings.painting.limits.minBatchSize,max:e.isVipUser?e.settings.painting.limits.maxBatchSize:4,step:1,size:"small"},on:{change:e.updateTokenUsage},model:{value:e.settings.batchSize,callback:function(t){e.$set(e.settings,"batchSize",t)},expression:"settings.batchSize"}}),!e.isVipUser&&e.settings.batchSize>1?t("el-tooltip",{attrs:{content:"批量生成需要VIP会员",placement:"top"}},[t("i",{staticClass:"el-icon-warning-outline",staticStyle:{color:"#E6A23C"}})]):e._e()],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("随机种子")]),t("div",{staticClass:"setting-control seed-row"},[t("el-input-number",{attrs:{min:-1,max:2147483647,step:1,size:"small"},model:{value:e.settings.seed,callback:function(t){e.$set(e.settings,"seed",t)},expression:"settings.seed"}}),t("el-tooltip",{attrs:{content:"使用-1表示随机种子",placement:"top"}},[t("i",{staticClass:"el-icon-question"})]),t("el-button",{staticClass:"seed-random-btn",attrs:{size:"mini",icon:"el-icon-refresh"},on:{click:e.randomizeSeed}})],1)])])]),t("div",{staticClass:"advanced-settings-toggle"},[t("div",{staticClass:"section-header"},[t("h3",[e._v("高级设置")]),t("el-switch",{model:{value:e.showAdvancedSettings,callback:function(t){e.showAdvancedSettings=t},expression:"showAdvancedSettings"}})],1)]),e.showAdvancedSettings?t("div",{staticClass:"advanced-settings"},[t("div",{staticClass:"section-content"},[t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("高清修复")]),t("div",{staticClass:"setting-control"},[t("el-switch",{on:{change:e.updateTokenUsage},model:{value:e.settings.advancedSettings.useHiresFix,callback:function(t){e.$set(e.settings.advancedSettings,"useHiresFix",t)},expression:"settings.advancedSettings.useHiresFix"}})],1)]),e.settings.advancedSettings.useHiresFix?t("div",{staticClass:"hires-fix-settings"},[t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("高清修复步数")]),t("div",{staticClass:"setting-control"},[t("el-input-number",{attrs:{min:1,max:50,step:1,size:"small"},model:{value:e.settings.advancedSettings.hiresSteps,callback:function(t){e.$set(e.settings.advancedSettings,"hiresSteps",t)},expression:"settings.advancedSettings.hiresSteps"}})],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("去噪强度")]),t("div",{staticClass:"setting-control"},[t("el-slider",{attrs:{min:0,max:1,step:.05},model:{value:e.settings.advancedSettings.hiresDenoisingStrength,callback:function(t){e.$set(e.settings.advancedSettings,"hiresDenoisingStrength",t)},expression:"settings.advancedSettings.hiresDenoisingStrength"}})],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("放大倍数")]),t("div",{staticClass:"setting-control"},[t("el-select",{attrs:{placeholder:"选择放大倍数"},model:{value:e.settings.advancedSettings.upscaler,callback:function(t){e.$set(e.settings.advancedSettings,"upscaler",t)},expression:"settings.advancedSettings.upscaler"}},[t("el-option",{attrs:{label:"1.5x",value:1.5}}),t("el-option",{attrs:{label:"2x",value:2}})],1)],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("缩放宽度")]),t("div",{staticClass:"setting-control"},[t("el-input-number",{attrs:{min:e.settings.width,max:2048,step:64,size:"small"},model:{value:e.settings.advancedSettings.resizedWidth,callback:function(t){e.$set(e.settings.advancedSettings,"resizedWidth",t)},expression:"settings.advancedSettings.resizedWidth"}})],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("缩放高度")]),t("div",{staticClass:"setting-control"},[t("el-input-number",{attrs:{min:e.settings.height,max:2048,step:64,size:"small"},model:{value:e.settings.advancedSettings.resizedHeight,callback:function(t){e.$set(e.settings.advancedSettings,"resizedHeight",t)},expression:"settings.advancedSettings.resizedHeight"}})],1)])]):e._e(),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("面部修复")]),t("div",{staticClass:"setting-control"},[t("el-switch",{on:{change:e.updateTokenUsage},model:{value:e.settings.faceRestoration,callback:function(t){e.$set(e.settings,"faceRestoration",t)},expression:"settings.faceRestoration"}}),e.settings.faceRestoration?t("span",{staticClass:"restore-face-hint"},[e._v("将应用面部修复")]):e._e()],1)])])]):e._e()]),t("div",{staticClass:"generate-button-section"},[t("div",{staticClass:"token-info"},[t("div",{staticClass:"token-count"},[t("span",[e._v("预计消耗积分: "),t("b",[e._v(e._s(e.totalTokens))])]),t("el-tooltip",{attrs:{content:"积分消耗根据图像分辨率、步数和批次计算",placement:"top"}},[t("i",{staticClass:"el-icon-question"})])],1),t("div",{staticClass:"user-tokens"},[t("span",[e._v("可用积分: "),t("b",[e._v(e._s(e.userTokens))])]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.openBuyTokens}},[e._v("购买积分")])],1)]),t("generate-button",{attrs:{"token-cost":e.totalTokens,"token-balance":e.userTokens,"is-generating":e.isGenerating,"generation-progress":e.generationProgress,"can-generate":e.canGenerate,"progress-text":e.progressText||"生成中...","show-stop-button":!0,"is-vip-user":e.isVipUser},on:{generate:e.handleGenerate,stop:e.handleStop,recharge:e.openBuyTokens,"open-vip":e.openVipOptions}}),e.isVipUser?e._e():t("div",{staticClass:"generation-limits"},[t("p",[e._v("免费用户每天限制生成 "+e._s(e.freeUserDailyLimit)+" 张图片 "),t("el-button",{attrs:{type:"text"},on:{click:e.openVipOptions}},[e._v("升级会员解锁更多")])],1)])],1)]),t("div",{staticClass:"image-preview-panel"},[t("div",{staticClass:"preview-header"},[t("h3",{staticClass:"preview-title"},[e._v("生成预览")]),e.generatedImages.length>0?t("div",{staticClass:"preview-actions"},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-download"},on:{click:e.saveAllImages}},[e._v("保存所有")]),t("el-button",{attrs:{size:"small",icon:"el-icon-delete"},on:{click:e.clearResults}},[e._v("清除结果")])],1):e._e()]),t("div",{staticClass:"preview-content"},[0===e.generatedImages.length?t("div",{staticClass:"empty-preview"},[e._m(1)]):t("div",{staticClass:"image-grid"},e._l(e.generatedImages,(function(s,i){return t("div",{key:i,staticClass:"image-item"},[t("div",{staticClass:"image-container"},[t("img",{staticClass:"generated-image",attrs:{src:s.url,alt:"生成的图片"}})]),t("div",{staticClass:"image-actions"},[t("el-button",{attrs:{type:"text",icon:"el-icon-view"},on:{click:function(t){return e.handleImageClick(s)}}},[e._v("查看")]),t("el-button",{attrs:{type:"text",icon:"el-icon-download"},on:{click:function(t){return e.downloadImage(s)}}},[e._v("下载")]),t("el-button",{attrs:{type:"text",icon:"el-icon-star-off"},on:{click:function(t){return e.favoriteImage(s)}}},[e._v("收藏")])],1)])})),0)]),e.isGenerating?t("div",{staticClass:"generation-progress"},[t("el-progress",{attrs:{percentage:e.generationProgress,format:e.progressFormat}}),t("p",[e._v("正在生成图像，请稍等...")])],1):e._e()])]),t("el-dialog",{attrs:{title:"图片预览",visible:e.previewDialogVisible,width:"70%"},on:{"update:visible":function(t){e.previewDialogVisible=t}}},[e.currentPreviewImage?t("div",{staticClass:"preview-dialog-content"},[t("el-image",{attrs:{src:e.currentPreviewImage.url,alt:"预览图片",fit:"contain"}}),t("div",{staticClass:"preview-info"},[t("div",{staticClass:"info-section"},[t("h4",[e._v("提示词")]),t("p",[e._v(e._s(e.prompts.positive))])]),t("div",{staticClass:"info-section"},[t("h4",[e._v("反向提示词")]),t("p",[e._v(e._s(e.prompts.negative||"无"))])]),t("div",{staticClass:"info-section"},[t("h4",[e._v("参数")]),t("div",{staticClass:"params-grid"},[t("div",{staticClass:"param-item"},[t("span",{staticClass:"label"},[e._v("尺寸")]),t("span",[e._v(e._s(e.settings.width)+" × "+e._s(e.settings.height))])]),t("div",{staticClass:"param-item"},[t("span",{staticClass:"label"},[e._v("采样器")]),t("span",[e._v(e._s(e.settings.sampler))])]),t("div",{staticClass:"param-item"},[t("span",{staticClass:"label"},[e._v("步数")]),t("span",[e._v(e._s(e.settings.steps))])]),t("div",{staticClass:"param-item"},[t("span",{staticClass:"label"},[e._v("CFG Scale")]),t("span",[e._v(e._s(e.settings.cfgScale))])]),t("div",{staticClass:"param-item"},[t("span",{staticClass:"label"},[e._v("种子")]),t("span",[e._v(e._s(e.currentPreviewImage.seed))])])])])])],1):e._e()]),t("el-dialog",{attrs:{title:"购买积分",visible:e.creditsDialog.visible,width:"40%"},on:{"update:visible":function(t){return e.$set(e.creditsDialog,"visible",t)}}},[t("div",{staticClass:"credit-packages"},e._l(e.creditPackages,(function(s,i){return t("div",{key:i,staticClass:"credit-package",class:{selected:e.creditsDialog.selectedPackage&&e.creditsDialog.selectedPackage.id===s.id},on:{click:function(t){return e.selectCreditPackage(s)}}},[t("div",{staticClass:"package-credits"},[e._v(e._s(s.amount)+"积分")]),t("div",{staticClass:"package-price"},[e._v("¥"+e._s(s.price))]),s.bonus?t("div",{staticClass:"package-info"},[t("el-tag",{attrs:{size:"mini",type:"success"}},[e._v("赠送"+e._s(s.bonus)+"积分")])],1):e._e()])})),0),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.creditsDialog.visible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",disabled:!e.creditsDialog.selectedPackage},on:{click:e.confirmCreditPurchase}},[e._v(" 确认购买 ")])],1)])],1)},l=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"section-header"},[t("h3",[e._v("图像设置")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"empty-placeholder"},[t("i",{staticClass:"el-icon-picture-outline"}),t("p",[e._v('请配置参数并点击"开始生成"按钮')])])}];s(8111),s(2489),s(7588),s(1701);function c(e){const{width:t=512,height:s=512,steps:i=30,batchSize:a=1,upscale:n=!1,faceRestore:o=!1}=e,r=262144,l=t*s,c=l/r;let d=Math.ceil(c*i*a);return n&&(d+=Math.ceil(.5*d)),o&&(d+=Math.ceil(.2*d)),d}function d(){return Math.floor(2147483647*Math.random())}function u(e=70,t=80){const s=Math.floor(360*Math.random());return`hsl(${s}, ${e}%, ${t}%)`}function p(){return[{value:"none",label:"不使用超分",description:"保持原始分辨率"},{value:"esrgan_4x",label:"ESRGAN 4x",description:"通用型超分，4倍放大"},{value:"sd_upscaler",label:"SD Upscaler",description:"使用Stable Diffusion进行超分"},{value:"real_esrgan_4x",label:"Real-ESRGAN 4x",description:"改进版ESRGAN，更好的细节保留"},{value:"waifu2x",label:"Waifu2x",description:"针对动漫图像优化"}]}function g(e,t){const{batchSize:s=1,steps:i=30}=e;return new Promise((a=>{const n=[];let o=0;const r=setInterval((()=>{if(o++,t&&t({step:o,totalSteps:i,percentage:Math.floor(o/i*100)}),o>=i){clearInterval(r);for(let t=0;t<s;t++){const s=d();n.push({id:`sim-${Date.now()}-${t}`,url:`https://picsum.photos/seed/${s}/512/512`,seed:s,prompt:e.prompt||"模拟生成的图像",params:{...e,seed:s}})}a(n)}}),100)}))}function h(e,t){return function(){return e.apply(t,arguments)}}const{toString:m}=Object.prototype,{getPrototypeOf:v}=Object,f=(e=>t=>{const s=m.call(t);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),b=e=>(e=e.toLowerCase(),t=>f(t)===e),C=e=>t=>typeof t===e,{isArray:_}=Array,w=C("undefined");function y(e){return null!==e&&!w(e)&&null!==e.constructor&&!w(e.constructor)&&P(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const k=b("ArrayBuffer");function x(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&k(e.buffer),t}const S=C("string"),P=C("function"),I=C("number"),T=e=>null!==e&&"object"===typeof e,D=e=>!0===e||!1===e,R=e=>{if("object"!==f(e))return!1;const t=v(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},E=b("Date"),$=b("File"),z=b("Blob"),O=b("FileList"),A=e=>T(e)&&P(e.pipe),F=e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||P(e.append)&&("formdata"===(t=f(e))||"object"===t&&P(e.toString)&&"[object FormData]"===e.toString()))},U=b("URLSearchParams"),[L,M,N,B]=["ReadableStream","Request","Response","Headers"].map(b),V=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function j(e,t,{allOwnKeys:s=!1}={}){if(null===e||"undefined"===typeof e)return;let i,a;if("object"!==typeof e&&(e=[e]),_(e))for(i=0,a=e.length;i<a;i++)t.call(null,e[i],i,e);else{const a=s?Object.getOwnPropertyNames(e):Object.keys(e),n=a.length;let o;for(i=0;i<n;i++)o=a[i],t.call(null,e[o],o,e)}}function G(e,t){t=t.toLowerCase();const s=Object.keys(e);let i,a=s.length;while(a-- >0)if(i=s[a],t===i.toLowerCase())return i;return null}const q=(()=>"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global)(),H=e=>!w(e)&&e!==q;function W(){const{caseless:e}=H(this)&&this||{},t={},s=(s,i)=>{const a=e&&G(t,i)||i;R(t[a])&&R(s)?t[a]=W(t[a],s):R(s)?t[a]=W({},s):_(s)?t[a]=s.slice():t[a]=s};for(let i=0,a=arguments.length;i<a;i++)arguments[i]&&j(arguments[i],s);return t}const K=(e,t,s,{allOwnKeys:i}={})=>(j(t,((t,i)=>{s&&P(t)?e[i]=h(t,s):e[i]=t}),{allOwnKeys:i}),e),J=e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),Q=(e,t,s,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),s&&Object.assign(e.prototype,s)},X=(e,t,s,i)=>{let a,n,o;const r={};if(t=t||{},null==e)return t;do{a=Object.getOwnPropertyNames(e),n=a.length;while(n-- >0)o=a[n],i&&!i(o,e,t)||r[o]||(t[o]=e[o],r[o]=!0);e=!1!==s&&v(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t},Y=(e,t,s)=>{e=String(e),(void 0===s||s>e.length)&&(s=e.length),s-=t.length;const i=e.indexOf(t,s);return-1!==i&&i===s},Z=e=>{if(!e)return null;if(_(e))return e;let t=e.length;if(!I(t))return null;const s=new Array(t);while(t-- >0)s[t]=e[t];return s},ee=(e=>t=>e&&t instanceof e)("undefined"!==typeof Uint8Array&&v(Uint8Array)),te=(e,t)=>{const s=e&&e[Symbol.iterator],i=s.call(e);let a;while((a=i.next())&&!a.done){const s=a.value;t.call(e,s[0],s[1])}},se=(e,t)=>{let s;const i=[];while(null!==(s=e.exec(t)))i.push(s);return i},ie=b("HTMLFormElement"),ae=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,s){return t.toUpperCase()+s})),ne=(({hasOwnProperty:e})=>(t,s)=>e.call(t,s))(Object.prototype),oe=b("RegExp"),re=(e,t)=>{const s=Object.getOwnPropertyDescriptors(e),i={};j(s,((s,a)=>{let n;!1!==(n=t(s,a,e))&&(i[a]=n||s)})),Object.defineProperties(e,i)},le=e=>{re(e,((t,s)=>{if(P(e)&&-1!==["arguments","caller","callee"].indexOf(s))return!1;const i=e[s];P(i)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")}))}))},ce=(e,t)=>{const s={},i=e=>{e.forEach((e=>{s[e]=!0}))};return _(e)?i(e):i(String(e).split(t)),s},de=()=>{},ue=(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t;function pe(e){return!!(e&&P(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])}const ge=e=>{const t=new Array(10),s=(e,i)=>{if(T(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[i]=e;const a=_(e)?[]:{};return j(e,((e,t)=>{const n=s(e,i+1);!w(n)&&(a[t]=n)})),t[i]=void 0,a}}return e};return s(e,0)},he=b("AsyncFunction"),me=e=>e&&(T(e)||P(e))&&P(e.then)&&P(e.catch),ve=((e,t)=>e?setImmediate:t?((e,t)=>(q.addEventListener("message",(({source:s,data:i})=>{s===q&&i===e&&t.length&&t.shift()()}),!1),s=>{t.push(s),q.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))("function"===typeof setImmediate,P(q.postMessage)),fe="undefined"!==typeof queueMicrotask?queueMicrotask.bind(q):"undefined"!==typeof process&&process.nextTick||ve;var be={isArray:_,isArrayBuffer:k,isBuffer:y,isFormData:F,isArrayBufferView:x,isString:S,isNumber:I,isBoolean:D,isObject:T,isPlainObject:R,isReadableStream:L,isRequest:M,isResponse:N,isHeaders:B,isUndefined:w,isDate:E,isFile:$,isBlob:z,isRegExp:oe,isFunction:P,isStream:A,isURLSearchParams:U,isTypedArray:ee,isFileList:O,forEach:j,merge:W,extend:K,trim:V,stripBOM:J,inherits:Q,toFlatObject:X,kindOf:f,kindOfTest:b,endsWith:Y,toArray:Z,forEachEntry:te,matchAll:se,isHTMLForm:ie,hasOwnProperty:ne,hasOwnProp:ne,reduceDescriptors:re,freezeMethods:le,toObjectSet:ce,toCamelCase:ae,noop:de,toFiniteNumber:ue,findKey:G,global:q,isContextDefined:H,isSpecCompliantForm:pe,toJSONObject:ge,isAsyncFn:he,isThenable:me,setImmediate:ve,asap:fe};function Ce(e,t,s,i,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),s&&(this.config=s),i&&(this.request=i),a&&(this.response=a,this.status=a.status?a.status:null)}be.inherits(Ce,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:be.toJSONObject(this.config),code:this.code,status:this.status}}});const _e=Ce.prototype,we={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{we[e]={value:e}})),Object.defineProperties(Ce,we),Object.defineProperty(_e,"isAxiosError",{value:!0}),Ce.from=(e,t,s,i,a,n)=>{const o=Object.create(_e);return be.toFlatObject(e,o,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),Ce.call(o,e.message,t,s,i,a),o.cause=e,o.name=e.name,n&&Object.assign(o,n),o};var ye=Ce,ke=null;function xe(e){return be.isPlainObject(e)||be.isArray(e)}function Se(e){return be.endsWith(e,"[]")?e.slice(0,-2):e}function Pe(e,t,s){return e?e.concat(t).map((function(e,t){return e=Se(e),!s&&t?"["+e+"]":e})).join(s?".":""):t}function Ie(e){return be.isArray(e)&&!e.some(xe)}const Te=be.toFlatObject(be,{},null,(function(e){return/^is[A-Z]/.test(e)}));function De(e,t,s){if(!be.isObject(e))throw new TypeError("target must be an object");t=t||new(ke||FormData),s=be.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!be.isUndefined(t[e])}));const i=s.metaTokens,a=s.visitor||d,n=s.dots,o=s.indexes,r=s.Blob||"undefined"!==typeof Blob&&Blob,l=r&&be.isSpecCompliantForm(t);if(!be.isFunction(a))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(be.isDate(e))return e.toISOString();if(!l&&be.isBlob(e))throw new ye("Blob is not supported. Use a Buffer instead.");return be.isArrayBuffer(e)||be.isTypedArray(e)?l&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function d(e,s,a){let r=e;if(e&&!a&&"object"===typeof e)if(be.endsWith(s,"{}"))s=i?s:s.slice(0,-2),e=JSON.stringify(e);else if(be.isArray(e)&&Ie(e)||(be.isFileList(e)||be.endsWith(s,"[]"))&&(r=be.toArray(e)))return s=Se(s),r.forEach((function(e,i){!be.isUndefined(e)&&null!==e&&t.append(!0===o?Pe([s],i,n):null===o?s:s+"[]",c(e))})),!1;return!!xe(e)||(t.append(Pe(a,s,n),c(e)),!1)}const u=[],p=Object.assign(Te,{defaultVisitor:d,convertValue:c,isVisitable:xe});function g(e,s){if(!be.isUndefined(e)){if(-1!==u.indexOf(e))throw Error("Circular reference detected in "+s.join("."));u.push(e),be.forEach(e,(function(e,i){const n=!(be.isUndefined(e)||null===e)&&a.call(t,e,be.isString(i)?i.trim():i,s,p);!0===n&&g(e,s?s.concat(i):[i])})),u.pop()}}if(!be.isObject(e))throw new TypeError("data must be an object");return g(e),t}var Re=De;function Ee(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function $e(e,t){this._pairs=[],e&&Re(e,this,t)}const ze=$e.prototype;ze.append=function(e,t){this._pairs.push([e,t])},ze.toString=function(e){const t=e?function(t){return e.call(this,t,Ee)}:Ee;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};var Oe=$e;function Ae(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Fe(e,t,s){if(!t)return e;const i=s&&s.encode||Ae;be.isFunction(s)&&(s={serialize:s});const a=s&&s.serialize;let n;if(n=a?a(t,s):be.isURLSearchParams(t)?t.toString():new Oe(t,s).toString(i),n){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e}class Ue{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!s&&s.synchronous,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){be.forEach(this.handlers,(function(t){null!==t&&e(t)}))}}var Le=Ue,Me={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ne="undefined"!==typeof URLSearchParams?URLSearchParams:Oe,Be="undefined"!==typeof FormData?FormData:null,Ve="undefined"!==typeof Blob?Blob:null,je={isBrowser:!0,classes:{URLSearchParams:Ne,FormData:Be,Blob:Ve},protocols:["http","https","file","blob","url","data"]};const Ge="undefined"!==typeof window&&"undefined"!==typeof document,qe="object"===typeof navigator&&navigator||void 0,He=Ge&&(!qe||["ReactNative","NativeScript","NS"].indexOf(qe.product)<0),We=(()=>"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts)(),Ke=Ge&&window.location.href||"http://localhost";var Je={...i,...je};function Qe(e,t){return Re(e,new Je.classes.URLSearchParams,Object.assign({visitor:function(e,t,s,i){return Je.isNode&&be.isBuffer(e)?(this.append(t,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function Xe(e){return be.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}function Ye(e){const t={},s=Object.keys(e);let i;const a=s.length;let n;for(i=0;i<a;i++)n=s[i],t[n]=e[n];return t}function Ze(e){function t(e,s,i,a){let n=e[a++];if("__proto__"===n)return!0;const o=Number.isFinite(+n),r=a>=e.length;if(n=!n&&be.isArray(i)?i.length:n,r)return be.hasOwnProp(i,n)?i[n]=[i[n],s]:i[n]=s,!o;i[n]&&be.isObject(i[n])||(i[n]=[]);const l=t(e,s,i[n],a);return l&&be.isArray(i[n])&&(i[n]=Ye(i[n])),!o}if(be.isFormData(e)&&be.isFunction(e.entries)){const s={};return be.forEachEntry(e,((e,i)=>{t(Xe(e),i,s,0)})),s}return null}var et=Ze;function tt(e,t,s){if(be.isString(e))try{return(t||JSON.parse)(e),be.trim(e)}catch(i){if("SyntaxError"!==i.name)throw i}return(s||JSON.stringify)(e)}const st={transitional:Me,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",i=s.indexOf("application/json")>-1,a=be.isObject(e);a&&be.isHTMLForm(e)&&(e=new FormData(e));const n=be.isFormData(e);if(n)return i?JSON.stringify(et(e)):e;if(be.isArrayBuffer(e)||be.isBuffer(e)||be.isStream(e)||be.isFile(e)||be.isBlob(e)||be.isReadableStream(e))return e;if(be.isArrayBufferView(e))return e.buffer;if(be.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(a){if(s.indexOf("application/x-www-form-urlencoded")>-1)return Qe(e,this.formSerializer).toString();if((o=be.isFileList(e))||s.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Re(o?{"files[]":e}:e,t&&new t,this.formSerializer)}}return a||i?(t.setContentType("application/json",!1),tt(e)):e}],transformResponse:[function(e){const t=this.transitional||st.transitional,s=t&&t.forcedJSONParsing,i="json"===this.responseType;if(be.isResponse(e)||be.isReadableStream(e))return e;if(e&&be.isString(e)&&(s&&!this.responseType||i)){const s=t&&t.silentJSONParsing,n=!s&&i;try{return JSON.parse(e)}catch(a){if(n){if("SyntaxError"===a.name)throw ye.from(a,ye.ERR_BAD_RESPONSE,this,null,this.response);throw a}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Je.classes.FormData,Blob:Je.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};be.forEach(["delete","get","head","post","put","patch"],(e=>{st.headers[e]={}}));var it=st;const at=be.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);var nt=e=>{const t={};let s,i,a;return e&&e.split("\n").forEach((function(e){a=e.indexOf(":"),s=e.substring(0,a).trim().toLowerCase(),i=e.substring(a+1).trim(),!s||t[s]&&at[s]||("set-cookie"===s?t[s]?t[s].push(i):t[s]=[i]:t[s]=t[s]?t[s]+", "+i:i)})),t};const ot=Symbol("internals");function rt(e){return e&&String(e).trim().toLowerCase()}function lt(e){return!1===e||null==e?e:be.isArray(e)?e.map(lt):String(e)}function ct(e){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;while(i=s.exec(e))t[i[1]]=i[2];return t}const dt=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function ut(e,t,s,i,a){return be.isFunction(i)?i.call(this,t,s):(a&&(t=s),be.isString(t)?be.isString(i)?-1!==t.indexOf(i):be.isRegExp(i)?i.test(t):void 0:void 0)}function pt(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,s)=>t.toUpperCase()+s))}function gt(e,t){const s=be.toCamelCase(" "+t);["get","set","has"].forEach((i=>{Object.defineProperty(e,i+s,{value:function(e,s,a){return this[i].call(this,t,e,s,a)},configurable:!0})}))}class ht{constructor(e){e&&this.set(e)}set(e,t,s){const i=this;function a(e,t,s){const a=rt(t);if(!a)throw new Error("header name must be a non-empty string");const n=be.findKey(i,a);(!n||void 0===i[n]||!0===s||void 0===s&&!1!==i[n])&&(i[n||t]=lt(e))}const n=(e,t)=>be.forEach(e,((e,s)=>a(e,s,t)));if(be.isPlainObject(e)||e instanceof this.constructor)n(e,t);else if(be.isString(e)&&(e=e.trim())&&!dt(e))n(nt(e),t);else if(be.isHeaders(e))for(const[o,r]of e.entries())a(r,o,s);else null!=e&&a(t,e,s);return this}get(e,t){if(e=rt(e),e){const s=be.findKey(this,e);if(s){const e=this[s];if(!t)return e;if(!0===t)return ct(e);if(be.isFunction(t))return t.call(this,e,s);if(be.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=rt(e),e){const s=be.findKey(this,e);return!(!s||void 0===this[s]||t&&!ut(this,this[s],s,t))}return!1}delete(e,t){const s=this;let i=!1;function a(e){if(e=rt(e),e){const a=be.findKey(s,e);!a||t&&!ut(s,s[a],a,t)||(delete s[a],i=!0)}}return be.isArray(e)?e.forEach(a):a(e),i}clear(e){const t=Object.keys(this);let s=t.length,i=!1;while(s--){const a=t[s];e&&!ut(this,this[a],a,e,!0)||(delete this[a],i=!0)}return i}normalize(e){const t=this,s={};return be.forEach(this,((i,a)=>{const n=be.findKey(s,a);if(n)return t[n]=lt(i),void delete t[a];const o=e?pt(a):String(a).trim();o!==a&&delete t[a],t[o]=lt(i),s[o]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return be.forEach(this,((s,i)=>{null!=s&&!1!==s&&(t[i]=e&&be.isArray(s)?s.join(", "):s)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const s=new this(e);return t.forEach((e=>s.set(e))),s}static accessor(e){const t=this[ot]=this[ot]={accessors:{}},s=t.accessors,i=this.prototype;function a(e){const t=rt(e);s[t]||(gt(i,e),s[t]=!0)}return be.isArray(e)?e.forEach(a):a(e),this}}ht.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),be.reduceDescriptors(ht.prototype,(({value:e},t)=>{let s=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[s]=e}}})),be.freezeMethods(ht);var mt=ht;function vt(e,t){const s=this||it,i=t||s,a=mt.from(i.headers);let n=i.data;return be.forEach(e,(function(e){n=e.call(s,n,a.normalize(),t?t.status:void 0)})),a.normalize(),n}function ft(e){return!(!e||!e.__CANCEL__)}function bt(e,t,s){ye.call(this,null==e?"canceled":e,ye.ERR_CANCELED,t,s),this.name="CanceledError"}be.inherits(bt,ye,{__CANCEL__:!0});var Ct=bt;function _t(e,t,s){const i=s.config.validateStatus;s.status&&i&&!i(s.status)?t(new ye("Request failed with status code "+s.status,[ye.ERR_BAD_REQUEST,ye.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s)):e(s)}function wt(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function yt(e,t){e=e||10;const s=new Array(e),i=new Array(e);let a,n=0,o=0;return t=void 0!==t?t:1e3,function(r){const l=Date.now(),c=i[o];a||(a=l),s[n]=r,i[n]=l;let d=o,u=0;while(d!==n)u+=s[d++],d%=e;if(n=(n+1)%e,n===o&&(o=(o+1)%e),l-a<t)return;const p=c&&l-c;return p?Math.round(1e3*u/p):void 0}}var kt=yt;function xt(e,t){let s,i,a=0,n=1e3/t;const o=(t,n=Date.now())=>{a=n,s=null,i&&(clearTimeout(i),i=null),e.apply(null,t)},r=(...e)=>{const t=Date.now(),r=t-a;r>=n?o(e,t):(s=e,i||(i=setTimeout((()=>{i=null,o(s)}),n-r)))},l=()=>s&&o(s);return[r,l]}var St=xt;const Pt=(e,t,s=3)=>{let i=0;const a=kt(50,250);return St((s=>{const n=s.loaded,o=s.lengthComputable?s.total:void 0,r=n-i,l=a(r),c=n<=o;i=n;const d={loaded:n,total:o,progress:o?n/o:void 0,bytes:r,rate:l||void 0,estimated:l&&o&&c?(o-n)/l:void 0,event:s,lengthComputable:null!=o,[t?"download":"upload"]:!0};e(d)}),s)},It=(e,t)=>{const s=null!=e;return[i=>t[0]({lengthComputable:s,total:e,loaded:i}),t[1]]},Tt=e=>(...t)=>be.asap((()=>e(...t)));var Dt=Je.hasStandardBrowserEnv?((e,t)=>s=>(s=new URL(s,Je.origin),e.protocol===s.protocol&&e.host===s.host&&(t||e.port===s.port)))(new URL(Je.origin),Je.navigator&&/(msie|trident)/i.test(Je.navigator.userAgent)):()=>!0,Rt=Je.hasStandardBrowserEnv?{write(e,t,s,i,a,n){const o=[e+"="+encodeURIComponent(t)];be.isNumber(s)&&o.push("expires="+new Date(s).toGMTString()),be.isString(i)&&o.push("path="+i),be.isString(a)&&o.push("domain="+a),!0===n&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Et(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function $t(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function zt(e,t,s){let i=!Et(t);return e&&(i||0==s)?$t(e,t):t}const Ot=e=>e instanceof mt?{...e}:e;function At(e,t){t=t||{};const s={};function i(e,t,s,i){return be.isPlainObject(e)&&be.isPlainObject(t)?be.merge.call({caseless:i},e,t):be.isPlainObject(t)?be.merge({},t):be.isArray(t)?t.slice():t}function a(e,t,s,a){return be.isUndefined(t)?be.isUndefined(e)?void 0:i(void 0,e,s,a):i(e,t,s,a)}function n(e,t){if(!be.isUndefined(t))return i(void 0,t)}function o(e,t){return be.isUndefined(t)?be.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function r(s,a,n){return n in t?i(s,a):n in e?i(void 0,s):void 0}const l={url:n,method:n,data:n,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:r,headers:(e,t,s)=>a(Ot(e),Ot(t),s,!0)};return be.forEach(Object.keys(Object.assign({},e,t)),(function(i){const n=l[i]||a,o=n(e[i],t[i],i);be.isUndefined(o)&&n!==r||(s[i]=o)})),s}var Ft=e=>{const t=At({},e);let s,{data:i,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:o,headers:r,auth:l}=t;if(t.headers=r=mt.from(r),t.url=Fe(zt(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&r.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),be.isFormData(i))if(Je.hasStandardBrowserEnv||Je.hasStandardBrowserWebWorkerEnv)r.setContentType(void 0);else if(!1!==(s=r.getContentType())){const[e,...t]=s?s.split(";").map((e=>e.trim())).filter(Boolean):[];r.setContentType([e||"multipart/form-data",...t].join("; "))}if(Je.hasStandardBrowserEnv&&(a&&be.isFunction(a)&&(a=a(t)),a||!1!==a&&Dt(t.url))){const e=n&&o&&Rt.read(o);e&&r.set(n,e)}return t};const Ut="undefined"!==typeof XMLHttpRequest;var Lt=Ut&&function(e){return new Promise((function(t,s){const i=Ft(e);let a=i.data;const n=mt.from(i.headers).normalize();let o,r,l,c,d,{responseType:u,onUploadProgress:p,onDownloadProgress:g}=i;function h(){c&&c(),d&&d(),i.cancelToken&&i.cancelToken.unsubscribe(o),i.signal&&i.signal.removeEventListener("abort",o)}let m=new XMLHttpRequest;function v(){if(!m)return;const i=mt.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders()),a=u&&"text"!==u&&"json"!==u?m.response:m.responseText,n={data:a,status:m.status,statusText:m.statusText,headers:i,config:e,request:m};_t((function(e){t(e),h()}),(function(e){s(e),h()}),n),m=null}m.open(i.method.toUpperCase(),i.url,!0),m.timeout=i.timeout,"onloadend"in m?m.onloadend=v:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(v)},m.onabort=function(){m&&(s(new ye("Request aborted",ye.ECONNABORTED,e,m)),m=null)},m.onerror=function(){s(new ye("Network Error",ye.ERR_NETWORK,e,m)),m=null},m.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const a=i.transitional||Me;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),s(new ye(t,a.clarifyTimeoutError?ye.ETIMEDOUT:ye.ECONNABORTED,e,m)),m=null},void 0===a&&n.setContentType(null),"setRequestHeader"in m&&be.forEach(n.toJSON(),(function(e,t){m.setRequestHeader(t,e)})),be.isUndefined(i.withCredentials)||(m.withCredentials=!!i.withCredentials),u&&"json"!==u&&(m.responseType=i.responseType),g&&([l,d]=Pt(g,!0),m.addEventListener("progress",l)),p&&m.upload&&([r,c]=Pt(p),m.upload.addEventListener("progress",r),m.upload.addEventListener("loadend",c)),(i.cancelToken||i.signal)&&(o=t=>{m&&(s(!t||t.type?new Ct(null,e,m):t),m.abort(),m=null)},i.cancelToken&&i.cancelToken.subscribe(o),i.signal&&(i.signal.aborted?o():i.signal.addEventListener("abort",o)));const f=wt(i.url);f&&-1===Je.protocols.indexOf(f)?s(new ye("Unsupported protocol "+f+":",ye.ERR_BAD_REQUEST,e)):m.send(a||null)}))};const Mt=(e,t)=>{const{length:s}=e=e?e.filter(Boolean):[];if(t||s){let s,i=new AbortController;const a=function(e){if(!s){s=!0,o();const t=e instanceof Error?e:this.reason;i.abort(t instanceof ye?t:new Ct(t instanceof Error?t.message:t))}};let n=t&&setTimeout((()=>{n=null,a(new ye(`timeout ${t} of ms exceeded`,ye.ETIMEDOUT))}),t);const o=()=>{e&&(n&&clearTimeout(n),n=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(a):e.removeEventListener("abort",a)})),e=null)};e.forEach((e=>e.addEventListener("abort",a)));const{signal:r}=i;return r.unsubscribe=()=>be.asap(o),r}};var Nt=Mt;const Bt=function*(e,t){let s=e.byteLength;if(!t||s<t)return void(yield e);let i,a=0;while(a<s)i=a+t,yield e.slice(a,i),a=i},Vt=async function*(e,t){for await(const s of jt(e))yield*Bt(s,t)},jt=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:s}=await t.read();if(e)break;yield s}}finally{await t.cancel()}},Gt=(e,t,s,i)=>{const a=Vt(e,t);let n,o=0,r=e=>{n||(n=!0,i&&i(e))};return new ReadableStream({async pull(e){try{const{done:t,value:i}=await a.next();if(t)return r(),void e.close();let n=i.byteLength;if(s){let e=o+=n;s(e)}e.enqueue(new Uint8Array(i))}catch(t){throw r(t),t}},cancel(e){return r(e),a.return()}},{highWaterMark:2})},qt="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,Ht=qt&&"function"===typeof ReadableStream,Wt=qt&&("function"===typeof TextEncoder?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Kt=(e,...t)=>{try{return!!e(...t)}catch(s){return!1}},Jt=Ht&&Kt((()=>{let e=!1;const t=new Request(Je.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),Qt=65536,Xt=Ht&&Kt((()=>be.isReadableStream(new Response("").body))),Yt={stream:Xt&&(e=>e.body)};qt&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach((t=>{!Yt[t]&&(Yt[t]=be.isFunction(e[t])?e=>e[t]():(e,s)=>{throw new ye(`Response type '${t}' is not supported`,ye.ERR_NOT_SUPPORT,s)})}))})(new Response);const Zt=async e=>{if(null==e)return 0;if(be.isBlob(e))return e.size;if(be.isSpecCompliantForm(e)){const t=new Request(Je.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return be.isArrayBufferView(e)||be.isArrayBuffer(e)?e.byteLength:(be.isURLSearchParams(e)&&(e+=""),be.isString(e)?(await Wt(e)).byteLength:void 0)},es=async(e,t)=>{const s=be.toFiniteNumber(e.getContentLength());return null==s?Zt(t):s};var ts=qt&&(async e=>{let{url:t,method:s,data:i,signal:a,cancelToken:n,timeout:o,onDownloadProgress:r,onUploadProgress:l,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:p}=Ft(e);c=c?(c+"").toLowerCase():"text";let g,h=Nt([a,n&&n.toAbortSignal()],o);const m=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let v;try{if(l&&Jt&&"get"!==s&&"head"!==s&&0!==(v=await es(d,i))){let e,s=new Request(t,{method:"POST",body:i,duplex:"half"});if(be.isFormData(i)&&(e=s.headers.get("content-type"))&&d.setContentType(e),s.body){const[e,t]=It(v,Pt(Tt(l)));i=Gt(s.body,Qt,e,t)}}be.isString(u)||(u=u?"include":"omit");const a="credentials"in Request.prototype;g=new Request(t,{...p,signal:h,method:s.toUpperCase(),headers:d.normalize().toJSON(),body:i,duplex:"half",credentials:a?u:void 0});let n=await fetch(g);const o=Xt&&("stream"===c||"response"===c);if(Xt&&(r||o&&m)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=n[t]}));const t=be.toFiniteNumber(n.headers.get("content-length")),[s,i]=r&&It(t,Pt(Tt(r),!0))||[];n=new Response(Gt(n.body,Qt,s,(()=>{i&&i(),m&&m()})),e)}c=c||"text";let f=await Yt[be.findKey(Yt,c)||"text"](n,e);return!o&&m&&m(),await new Promise(((t,s)=>{_t(t,s,{data:f,headers:mt.from(n.headers),status:n.status,statusText:n.statusText,config:e,request:g})}))}catch(f){if(m&&m(),f&&"TypeError"===f.name&&/fetch/i.test(f.message))throw Object.assign(new ye("Network Error",ye.ERR_NETWORK,e,g),{cause:f.cause||f});throw ye.from(f,f&&f.code,e,g)}});const ss={http:ke,xhr:Lt,fetch:ts};be.forEach(ss,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(s){}Object.defineProperty(e,"adapterName",{value:t})}}));const is=e=>`- ${e}`,as=e=>be.isFunction(e)||null===e||!1===e;var ns={getAdapter:e=>{e=be.isArray(e)?e:[e];const{length:t}=e;let s,i;const a={};for(let n=0;n<t;n++){let t;if(s=e[n],i=s,!as(s)&&(i=ss[(t=String(s)).toLowerCase()],void 0===i))throw new ye(`Unknown adapter '${t}'`);if(i)break;a[t||"#"+n]=i}if(!i){const e=Object.entries(a).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));let s=t?e.length>1?"since :\n"+e.map(is).join("\n"):" "+is(e[0]):"as no adapter specified";throw new ye("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return i},adapters:ss};function os(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ct(null,e)}function rs(e){os(e),e.headers=mt.from(e.headers),e.data=vt.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);const t=ns.getAdapter(e.adapter||it.adapter);return t(e).then((function(t){return os(e),t.data=vt.call(e,e.transformResponse,t),t.headers=mt.from(t.headers),t}),(function(t){return ft(t)||(os(e),t&&t.response&&(t.response.data=vt.call(e,e.transformResponse,t.response),t.response.headers=mt.from(t.response.headers))),Promise.reject(t)}))}const ls="1.8.4",cs={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{cs[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}}));const ds={};function us(e,t,s){if("object"!==typeof e)throw new ye("options must be an object",ye.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let a=i.length;while(a-- >0){const n=i[a],o=t[n];if(o){const t=e[n],s=void 0===t||o(t,n,e);if(!0!==s)throw new ye("option "+n+" must be "+s,ye.ERR_BAD_OPTION_VALUE)}else if(!0!==s)throw new ye("Unknown option "+n,ye.ERR_BAD_OPTION)}}cs.transitional=function(e,t,s){function i(e,t){return"[Axios v"+ls+"] Transitional option '"+e+"'"+t+(s?". "+s:"")}return(s,a,n)=>{if(!1===e)throw new ye(i(a," has been removed"+(t?" in "+t:"")),ye.ERR_DEPRECATED);return t&&!ds[a]&&(ds[a]=!0,console.warn(i(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(s,a,n)}},cs.spelling=function(e){return(t,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};var ps={assertOptions:us,validators:cs};const gs=ps.validators;class hs{constructor(e){this.defaults=e,this.interceptors={request:new Le,response:new Le}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{s.stack?t&&!String(s.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(s.stack+="\n"+t):s.stack=t}catch(i){}}throw s}}_request(e,t){"string"===typeof e?(t=t||{},t.url=e):t=e||{},t=At(this.defaults,t);const{transitional:s,paramsSerializer:i,headers:a}=t;void 0!==s&&ps.assertOptions(s,{silentJSONParsing:gs.transitional(gs.boolean),forcedJSONParsing:gs.transitional(gs.boolean),clarifyTimeoutError:gs.transitional(gs.boolean)},!1),null!=i&&(be.isFunction(i)?t.paramsSerializer={serialize:i}:ps.assertOptions(i,{encode:gs.function,serialize:gs.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),ps.assertOptions(t,{baseUrl:gs.spelling("baseURL"),withXsrfToken:gs.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let n=a&&be.merge(a.common,a[t.method]);a&&be.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete a[e]})),t.headers=mt.concat(n,a);const o=[];let r=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(r=r&&e.synchronous,o.unshift(e.fulfilled,e.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let d,u=0;if(!r){const e=[rs.bind(this),void 0];e.unshift.apply(e,o),e.push.apply(e,l),d=e.length,c=Promise.resolve(t);while(u<d)c=c.then(e[u++],e[u++]);return c}d=o.length;let p=t;u=0;while(u<d){const e=o[u++],t=o[u++];try{p=e(p)}catch(g){t.call(this,g);break}}try{c=rs.call(this,p)}catch(g){return Promise.reject(g)}u=0,d=l.length;while(u<d)c=c.then(l[u++],l[u++]);return c}getUri(e){e=At(this.defaults,e);const t=zt(e.baseURL,e.url,e.allowAbsoluteUrls);return Fe(t,e.params,e.paramsSerializer)}}be.forEach(["delete","get","head","options"],(function(e){hs.prototype[e]=function(t,s){return this.request(At(s||{},{method:e,url:t,data:(s||{}).data}))}})),be.forEach(["post","put","patch"],(function(e){function t(t){return function(s,i,a){return this.request(At(a||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:s,data:i}))}}hs.prototype[e]=t(),hs.prototype[e+"Form"]=t(!0)}));var ms=hs;class vs{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const s=this;this.promise.then((e=>{if(!s._listeners)return;let t=s._listeners.length;while(t-- >0)s._listeners[t](e);s._listeners=null})),this.promise.then=e=>{let t;const i=new Promise((e=>{s.subscribe(e),t=e})).then(e);return i.cancel=function(){s.unsubscribe(t)},i},e((function(e,i,a){s.reason||(s.reason=new Ct(e,i,a),t(s.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;const t=new vs((function(t){e=t}));return{token:t,cancel:e}}}var fs=vs;function bs(e){return function(t){return e.apply(null,t)}}function Cs(e){return be.isObject(e)&&!0===e.isAxiosError}const _s={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(_s).forEach((([e,t])=>{_s[t]=e}));var ws=_s;function ys(e){const t=new ms(e),s=h(ms.prototype.request,t);return be.extend(s,ms.prototype,t,{allOwnKeys:!0}),be.extend(s,t,null,{allOwnKeys:!0}),s.create=function(t){return ys(At(e,t))},s}const ks=ys(it);ks.Axios=ms,ks.CanceledError=Ct,ks.CancelToken=fs,ks.isCancel=ft,ks.VERSION=ls,ks.toFormData=Re,ks.AxiosError=ye,ks.Cancel=ks.CanceledError,ks.all=function(e){return Promise.all(e)},ks.spread=bs,ks.isAxiosError=Cs,ks.mergeConfig=At,ks.AxiosHeaders=mt,ks.formToJSON=e=>et(be.isHTMLForm(e)?new FormData(e):e),ks.getAdapter=ns.getAdapter,ks.HttpStatusCode=ws,ks.default=ks;var xs=ks,Ss=s(1052);const Ps=xs.create({baseURL:{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_BASE_API||"",timeout:6e4,withCredentials:!0});Ps.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers["Authorization"]=`Bearer ${t}`),e}),(e=>(console.error("请求错误",e),Promise.reject(e)))),Ps.interceptors.response.use((e=>{const t=e.data;return 200===e.status?t:((0,Ss.Message)({message:t.message||"请求异常",type:"error",duration:5e3}),401===t.code&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(new Error(t.message||"请求异常")))}),(e=>(console.error("响应错误",e),(0,Ss.Message)({message:e.message,type:"error",duration:5e3}),Promise.reject(e))));const Is=(e,t)=>Ps({url:e,method:"get",params:t}),Ts=(e,t)=>Ps({url:e,method:"post",data:t}),Ds=(e,t)=>Ps({url:e,method:"put",data:t}),Rs=(e,t)=>Ps({url:e,method:"delete",data:t});var Es={get:Is,post:Ts,put:Ds,delete:Rs},$s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"generate-button-container"},[t("div",{staticClass:"credit-info"},[t("div",{staticClass:"token-info"},[t("span",{staticClass:"token-label"},[e._v("消耗积分：")]),t("span",{staticClass:"token-value"},[e._v(e._s(e.tokenCost))]),t("el-tooltip",{attrs:{content:"生成一张图像消耗的积分数量",placement:"top"}},[t("i",{staticClass:"el-icon-question"})])],1),t("div",{staticClass:"balance-info"},[t("span",{staticClass:"balance-label"},[e._v("剩余积分：")]),t("span",{staticClass:"balance-value",class:{"low-balance":e.isLowBalance}},[e._v(e._s(e.tokenBalance))]),t("el-button",{staticClass:"recharge-button",attrs:{type:"text"},on:{click:e.showRechargeDialog}},[e._v("充值")])],1)]),t("div",{staticClass:"queue-selection"},[t("div",{staticClass:"queue-options"},[t("div",{staticClass:"queue-option",class:{active:"normal"===e.selectedQueue},on:{click:function(t){return e.selectQueue("normal")}}},[e._m(0),t("div",{staticClass:"queue-info"},[t("h4",[e._v("普通队列")]),t("p",[e._v("预计等待时间: "+e._s(e.normalQueueWaitTime))])])]),t("div",{staticClass:"queue-option vip",class:{active:"vip"===e.selectedQueue,disabled:!e.isVipUser},on:{click:function(t){return e.selectQueue("vip")}}},[e._m(1),t("div",{staticClass:"queue-info"},[t("h4",[e._v("会员加速 "),t("el-tag",{attrs:{size:"mini",type:"warning"}},[e._v("VIP")])],1),t("p",[e._v("立即生成，优先处理")])]),e.isVipUser?e._e():t("div",{staticClass:"vip-lock"},[t("i",{staticClass:"el-icon-lock"})])])]),e.isVipUser?e._e():t("div",{staticClass:"upgrade-tip"},[t("p",[e._v("开通VIP会员可享受优先生成特权 "),t("el-button",{attrs:{type:"text"},on:{click:e.openVipOptions}},[e._v("立即开通")])],1)])]),t("div",{staticClass:"buttons-row"},[t("el-button",{staticClass:"generate-button",attrs:{type:"primary",disabled:e.isGenerating||!e.canGenerate,loading:e.isGenerating},on:{click:e.onGenerate}},[e._v(" "+e._s(e.generateButtonText)+" ")]),e.showStopButton?t("el-button",{staticClass:"stop-button",attrs:{type:"danger",disabled:!e.isGenerating},on:{click:e.onStop}},[e._v(" 停止生成 ")]):e._e()],1),e.isGenerating?t("div",{staticClass:"progress-info"},[t("el-progress",{staticClass:"progress-bar",attrs:{percentage:e.generationProgress,"show-text":!1}}),t("div",{staticClass:"progress-text"},[t("span",[e._v(e._s(e.progressText))]),t("span",[e._v(e._s(e.generationProgress)+"%")])])],1):e._e()])},zs=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"queue-icon"},[t("i",{staticClass:"el-icon-time"})])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"queue-icon"},[t("i",{staticClass:"el-icon-lightning"})])}],Os={name:"GenerateButton",props:{tokenCost:{type:[Number,String],default:1},tokenBalance:{type:[Number,String],default:10},isGenerating:{type:Boolean,default:!1},generationProgress:{type:Number,default:0},canGenerate:{type:Boolean,default:!0},progressText:{type:String,default:"生成中..."},showStopButton:{type:Boolean,default:!0},isVipUser:{type:Boolean,default:!1}},data(){return{selectedQueue:"normal",normalQueueWaitTime:"约3-5分钟"}},computed:{isLowBalance(){return parseFloat(this.tokenBalance)<parseFloat(this.tokenCost)},generateButtonText(){return this.isGenerating?"生成中...":"生成图像"}},methods:{onGenerate(){this.isLowBalance?this.showRechargeDialog():this.$emit("generate",{queueType:this.selectedQueue})},onStop(){this.$emit("stop")},showRechargeDialog(){this.$emit("recharge")},selectQueue(e){"vip"!==e||this.isVipUser?this.selectedQueue=e:this.openVipOptions()},openVipOptions(){this.$emit("open-vip")}}},As=Os,Fs=s(1656),Us=(0,Fs.A)(As,$s,zs,!1,null,"0456f6b6",null),Ls=Us.exports,Ms=s(9325);const Ns=xs.create({timeout:1e4});Ns.interceptors.request.use((e=>(null!==localStorage.getItem("token")&&(e.headers["Authorization"]=localStorage.getItem("token")),e)),(e=>Promise.reject(e))),Ns.interceptors.response.use((e=>{const t=e.data.code;return 0===t&&"/login"!==Ms.A.currentRoute.path&&Ms.A.push("/login"),e.data}),(e=>Promise.reject(e)));var Bs=Ns;function Vs(){return Bs({url:"/api/image/model/checkPointId",method:"get"})}function js(e){const t={prompt:e.prompt,imgCount:e.imgCount,sourceImage:e.sourceImage,width:e.width,height:e.height,userId:1};return Bs({url:"/api/image/start/image-to-image",method:"post",data:t})}function Gs(e){const t={prompt:e.prompt,aspectRatio:"square",imgCount:e.imgCount,imageSize:{width:e.width,height:e.height},userId:1};return Es.post("/api/image/start/text-to-image",t)}var qs={name:"TextToImageTab",components:{GenerateButton:Ls},data(){return{generateId:"",taskId:"",isGenerating:!1,generationProgress:0,progressText:"生成中...",generatedImages:[],modelList:[],templateList:[],samplerList:[{label:"Euler a",value:0},{label:"Euler",value:1},{label:"LMS",value:2},{label:"Heun",value:3},{label:"DPM2",value:4},{label:"DPM2 a",value:5},{label:"DPM++ 2S a",value:6},{label:"DPM++ 2M",value:7},{label:"DPM++ SDE",value:8},{label:"DPM fast",value:9},{label:"DPM adaptive",value:10},{label:"LMS Karras",value:11},{label:"DPM2 Karras",value:12},{label:"DPM2 a Karras",value:13},{label:"DPM++ 2S a Karras",value:14},{label:"DPM++ 2M Karras",value:15},{label:"DPM++ SDE Karras",value:16},{label:"DDIM",value:17},{label:"PLMS",value:18}],upscalerList:[{label:"ESRGAN_4x",value:"esrgan_4x"},{label:"R-ESRGAN 4x+",value:"r_esrgan_4x_plus"},{label:"LDSR",value:"ldsr"}],clipSkipValue:1,currentGenerateTask:{generateId:null,taskId:null},settings:{model:"",template:"",width:512,height:512,sampler:0,steps:30,cfgScale:7,seed:-1,batchSize:1,useClipSkip:!1,faceRestoration:!1,advancedSettings:{useHiresFix:!1,hiresSteps:20,hiresDenoisingStrength:.7,upscaler:1.5,resizedWidth:768,resizedHeight:768},painting:{limits:{minSize:256,maxSize:1024,minSteps:1,maxSteps:150,minCfgScale:1,maxCfgScale:30,minBatchSize:1,maxBatchSize:4,minUpscaleScale:1,maxUpscaleScale:4}}},prompts:{positive:"",negative:""},showAdvancedSettings:!1,previewDialogVisible:!1,currentPreviewImage:null,isVipUser:!1,userTokens:50,freeUserDailyLimit:3,creditsDialog:{visible:!1,selectedPackage:null},creditPackages:[{id:1,amount:100,price:10,bonus:10},{id:2,amount:200,price:18,bonus:20},{id:3,amount:500,price:40,bonus:50},{id:4,amount:1e3,price:70,bonus:100}]}},computed:{canGenerate(){return!this.isGenerating&&""!==this.prompts.positive.trim()&&""!==this.settings.model&&""!==this.settings.template&&this.userTokens>=this.totalTokens},totalTokens(){return c({width:this.settings.width,height:this.settings.height,steps:this.settings.steps,batchSize:this.settings.batchSize,model:this.settings.model,upscale:this.settings.useUpscale,faceRestore:this.settings.faceRestoration,hiresFix:this.settings.advancedSettings.useHiresFix})}},mounted(){this.getModelList()},methods:{getModelList(){Vs().then((e=>{const t=e.data,s=t.filter((e=>0===e.type)),i=s.map((e=>({label:e.modelName,value:e.modelUuid,description:e.modelVersion||""}))),a=t.filter((e=>2===e.type)),n=a.map((e=>e.modelName.includes("文生图")?{label:e.modelName,value:e.modelUuid,description:e.modelVersion||""}:null)).filter((e=>null!==e)),o={label:"星流start",value:"0",description:"默认模型"};this.modelList=i,this.templateList=n,this.templateList.unshift(o),console.log("获取到的模型列表:",this.modelList),console.log("获取到的模板列表:",this.templateList),i.length>0&&(this.settings.model=i[0].value),n.length>0&&(this.settings.template=n[0].value)})).catch((e=>{console.error("获取模型和模板列表失败",e),this.$message.error("获取模型和模板列表失败: "+(e.message||"未知错误")),this.modelList=[{label:"默认模型",value:"default_model",description:"预设模型"}],this.templateList=[{label:"默认模板",value:"default_template",description:"预设模板"}],this.settings.model="default_model",this.settings.template="default_template"}))},async handleGenerate(){if(localStorage.getItem("token"))if(this.prompts.positive){this.isGenerating=!0,this.generationProgress=0,this.progressText="准备生成...";try{const e=this.prompts.positive,t=this.settings.width,s=this.settings.height,i=this.settings.batchSize;if("0"===this.settings.template){console.log("使用星流start模板生成图片");const a={prompt:e,imgCount:i,width:t,height:s};console.log("星流start请求参数:",a);const n=await Gs(a);if(console.log("星流start响应:",n),!n.data||!n.data.taskId)throw new Error("获取任务ID失败");this.taskId=n.data.taskId,this.generateId=n.data.generateId,this.progressText="开始生成...",await this.pollGenerationResult()}else{const a=-1===this.settings.seed?null:this.settings.seed,n=this.prepareTextToImageParams(e,t,s,a,i);console.log("普通请求参数:",n);const o=await Es.post("/api/image/customize/text-to-image",n);if(!o.data||!o.data.taskId)throw new Error("获取任务ID失败");this.taskId=o.data.taskId,this.generateId=o.data.generateId,this.progressText="开始生成...",await this.pollGenerationResult()}}catch(e){console.error("生成失败:",e),this.$message.error("图片生成失败，请稍后再试"),this.isGenerating=!1,this.progressText="生成失败"}}else this.$message.warning("请输入提示词");else this.$message.warning("请先登录")},async pollGenerationResult(){try{const e=await Es.get("/api/image/get-images?&taskId="+this.taskId);if(!e)throw new Error(e?.message||"获取生成结果失败");if(e.data.percentCompleted>1)return this.generatedImages=e.data.images.map(((e,t)=>({url:e.imageUrl,seed:-1===this.settings.seed?`生成的随机种子_${t}`:this.settings.seed}))),this.userTokens-=this.totalTokens,this.$message.success("图像生成成功"),this.isGenerating=!1,void(this.progressText="生成完成");if(void 0!==e.data.percentCompleted){this.generationProgress=100*e.data.percentCompleted;const t=Math.floor(100*e.data.percentCompleted);this.progressText=`生成中... ${t}%`}setTimeout((()=>this.pollGenerationResult()),2e3)}catch(e){console.error("获取生成结果失败",e),this.$message.error("获取生成结果失败: "+(e.message||"未知错误")),this.isGenerating=!1,this.progressText="生成失败"}},async handleStop(){try{this.generateId&&this.taskId&&await Es.post("/api/image/cancel-task",{generateId:this.generateId,taskId:this.taskId}),this.isGenerating=!1,this.generationProgress=0,this.progressText="已停止生成",this.$message.info("已停止生成")}catch(e){console.error("停止生成失败",e),this.$message.error("停止失败: "+(e.message||"未知错误"))}},clearResults(){this.generatedImages=[],this.$message.success("已清除所有结果")},handleImageClick(e){this.currentPreviewImage=e,this.previewDialogVisible=!0},openBuyTokens(){this.creditsDialog.visible=!0},openVipOptions(){this.$message.info("VIP会员功能正在开发中...")},saveAllImages(){0!==this.generatedImages.length?(this.generatedImages.forEach(((e,t)=>{this.downloadImage(e,`generated_image_${t+1}`)})),this.$message.success("所有图像已开始下载")):this.$message.warning("没有可保存的图像")},downloadImage(e,t="generated_image"){const s=document.createElement("a");s.href=e.url,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)},progressFormat(e){return`${e}%`},translatePrompt(){this.prompts.positive?this.$message.info("翻译功能正在开发中..."):this.$message.warning("请先输入提示词")},useDefaultNegativePrompt(){this.prompts.negative="low quality, bad anatomy, worst quality, blurry, distorted face, bad proportions, deformed, ugly, disfigured",this.$message.info("已使用默认负向提示词")},showPromptLibrary(){this.$message.info("提示词库功能正在开发中...")},showNegativeLibrary(){this.$message.info("负向提示词库功能正在开发中...")},refreshModels(){this.$message.info("正在刷新模型和模板列表..."),this.getModelList()},updateTokenUsage(){console.log("更新积分消耗")},randomizeSeed(){this.settings.seed=d(),this.$message.info(`已生成随机种子: ${this.settings.seed}`)},favoriteImage(e){this.$message.success("图片已添加到收藏夹")},prepareTextToImageParams(e,t,s){return{templateUuid:"1111111",checkPointId:"string",prompt:e,sampler:0,steps:30,cfgScale:7.5,width:t,height:s,imgCount:1,seed:-1,clipSkip:0,restoreFaces:this.settings.faceRestoration?1:0,hiResFixInfoPojo:{hiresSteps:0,hiresDenoisingStrength:0,upscaler:0,resizedWidth:0,resizedHeight:0},userId:1}},selectCreditPackage(e){this.creditsDialog.selectedPackage=e},confirmCreditPurchase(){if(!this.creditsDialog.selectedPackage)return;const e=this.creditsDialog.selectedPackage;this.userTokens+=e.amount+(e.bonus||0),this.$message.success(`您已成功购买${e.amount}积分${e.bonus?"，赠送"+e.bonus+"积分":""}！`),this.creditsDialog.visible=!1,this.creditsDialog.selectedPackage=null}}},Hs=qs,Ws=(0,Fs.A)(Hs,r,l,!1,null,"7d7717ae",null),Ks=Ws.exports,Js=function(){var e=this,t=e._self._c;return t("div",{staticClass:"image-to-image-tab"},[t("div",{staticClass:"tab-content"},[t("div",{staticClass:"control-panel"},[t("div",{staticClass:"upload-section"},[t("image-uploader",{attrs:{"main-text":"拖放图片或点击上传","sub-text":"支持JPG/PNG格式，最大5MB"},on:{change:e.handleImageUpload},model:{value:e.sourceImage,callback:function(t){e.sourceImage=t},expression:"sourceImage"}})],1),t("div",{staticClass:"prompts-section"},[t("div",{staticClass:"prompt-input"},[t("label",[e._v("提示词 Prompt")]),t("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入正向提示词描述你想要的图像内容",resize:"none",maxlength:"1000","show-word-limit":""},model:{value:e.prompts.positive,callback:function(t){e.$set(e.prompts,"positive",t)},expression:"prompts.positive"}}),t("div",{staticClass:"prompt-tips"},[e._v(" 提示：使用详细和具体的描述，提及风格、光线、视角和场景会得到更好的结果 "),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.translatePrompt}},[e._v("翻译为英文")]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.showPromptLibrary}},[e._v("提示词库")])],1)],1),t("div",{staticClass:"negative-prompt"},[t("label",[e._v("负向提示词 Negative Prompt")]),t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入负向提示词描述你不想在图像中出现的元素",resize:"none",maxlength:"500","show-word-limit":""},model:{value:e.prompts.negative,callback:function(t){e.$set(e.prompts,"negative",t)},expression:"prompts.negative"}}),t("div",{staticClass:"prompt-tips"},[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.useDefaultNegativePrompt}},[e._v("使用默认")]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.showNegativeLibrary}},[e._v("负向提示词库")])],1)],1)]),t("div",{staticClass:"settings-section"},[t("div",{staticClass:"model-selection"},[t("div",{staticClass:"model-header-row"},[t("div",{staticClass:"checkpoint-selector"},[t("span",{staticClass:"model-label"},[e._v("基础模型")]),t("div",{staticClass:"selector-container"},[t("el-select",{staticClass:"model-select",attrs:{placeholder:"选择基础模型"},model:{value:e.settings.model,callback:function(t){e.$set(e.settings,"model",t)},expression:"settings.model"}},e._l(e.modelList,(function(s){return t("el-option",{key:s.value,attrs:{label:s.label,value:s.value}},[t("span",[e._v(e._s(s.label))]),t("span",{staticClass:"model-description"},[e._v(e._s(s.description))])])})),1),t("el-button",{staticClass:"refresh-btn",attrs:{type:"primary",icon:"el-icon-refresh",size:"mini",circle:""},on:{click:e.refreshModels}})],1)])]),t("div",{staticClass:"model-header-row"},[t("div",{staticClass:"checkpoint-selector"},[t("span",{staticClass:"model-label"},[e._v("模板")]),t("div",{staticClass:"selector-container"},[t("el-select",{staticClass:"model-select",attrs:{placeholder:"选择模板"},model:{value:e.settings.template,callback:function(t){e.$set(e.settings,"template",t)},expression:"settings.template"}},e._l(e.templateList,(function(s){return t("el-option",{key:s.value,attrs:{label:s.label,value:s.value}},[t("span",[e._v(e._s(s.label))]),t("span",{staticClass:"model-description"},[e._v(e._s(s.description))])])})),1)],1)])]),t("div",{staticClass:"clip-skip"},[t("div",{staticClass:"clip-header"},[t("span",{staticClass:"model-label"},[e._v("CLIP跳过层Clip Skip")]),t("el-tooltip",{attrs:{content:"控制CLIP模型内部使用第几层作为文本特征",placement:"top"}},[t("i",{staticClass:"el-icon-question"})])],1),t("div",{staticClass:"clip-controls"},[t("el-input-number",{staticClass:"clip-input",attrs:{min:1,max:12,step:1,size:"small"},model:{value:e.clipSkipValue,callback:function(t){e.clipSkipValue=t},expression:"clipSkipValue"}}),t("el-switch",{staticClass:"clip-switch",model:{value:e.settings.useClipSkip,callback:function(t){e.$set(e.settings,"useClipSkip",t)},expression:"settings.useClipSkip"}})],1)])]),t("div",{staticClass:"image-settings"},[e._m(0),t("div",{staticClass:"section-content"},[t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("采样器")]),t("div",{staticClass:"setting-control"},[t("el-select",{attrs:{placeholder:"选择采样器",size:"small"},on:{change:e.updateTokenUsage},model:{value:e.settings.sampler,callback:function(t){e.$set(e.settings,"sampler",t)},expression:"settings.sampler"}},e._l(e.samplerList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("图像尺寸")]),t("div",{staticClass:"setting-control size-inputs"},[t("el-input-number",{attrs:{min:256,max:2048,step:64,size:"small"},on:{change:e.validateSize},model:{value:e.settings.width,callback:function(t){e.$set(e.settings,"width",t)},expression:"settings.width"}}),t("span",{staticClass:"size-separator"},[e._v("×")]),t("el-input-number",{attrs:{min:256,max:2048,step:64,size:"small"},on:{change:e.validateSize},model:{value:e.settings.height,callback:function(t){e.$set(e.settings,"height",t)},expression:"settings.height"}})],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("步数")]),t("div",{staticClass:"setting-control"},[t("el-slider",{attrs:{min:1,max:150,step:1,"show-input":"",size:"small"},on:{change:e.updateTokenUsage},model:{value:e.settings.steps,callback:function(t){e.$set(e.settings,"steps",t)},expression:"settings.steps"}})],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("CFG Scale")]),t("div",{staticClass:"setting-control"},[t("el-slider",{attrs:{min:1,max:30,step:.5,"show-input":"",size:"small"},on:{change:e.updateTokenUsage},model:{value:e.settings.cfgScale,callback:function(t){e.$set(e.settings,"cfgScale",t)},expression:"settings.cfgScale"}})],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("去噪强度")]),t("div",{staticClass:"setting-control"},[t("el-slider",{attrs:{min:0,max:1,step:.05,"show-input":"",size:"small"},model:{value:e.settings.denoisingStrength,callback:function(t){e.$set(e.settings,"denoisingStrength",t)},expression:"settings.denoisingStrength"}})],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("批次大小")]),t("div",{staticClass:"setting-control"},[t("el-input-number",{attrs:{min:1,max:e.isVipUser?4:1,step:1,size:"small"},on:{change:e.updateTokenUsage},model:{value:e.settings.imgCount,callback:function(t){e.$set(e.settings,"imgCount",t)},expression:"settings.imgCount"}}),!e.isVipUser&&e.settings.imgCount>1?t("el-tooltip",{attrs:{content:"批量生成需要VIP会员",placement:"top"}},[t("i",{staticClass:"el-icon-warning-outline",staticStyle:{color:"#E6A23C"}})]):e._e()],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("随机种子")]),t("div",{staticClass:"setting-control seed-row"},[t("el-input-number",{attrs:{min:-1,max:2147483647,step:1,size:"small"},model:{value:e.settings.seed,callback:function(t){e.$set(e.settings,"seed",t)},expression:"settings.seed"}}),t("el-tooltip",{attrs:{content:"使用-1表示随机种子",placement:"top"}},[t("i",{staticClass:"el-icon-question"})]),t("el-button",{staticClass:"seed-random-btn",attrs:{size:"mini",icon:"el-icon-refresh"},on:{click:e.randomizeSeed}})],1)])])]),t("div",{staticClass:"advanced-settings-toggle"},[t("div",{staticClass:"section-header"},[t("h3",[e._v("高清修复设置")]),t("el-switch",{on:{change:e.updateTokenUsage},model:{value:e.settings.useHiresFix,callback:function(t){e.$set(e.settings,"useHiresFix",t)},expression:"settings.useHiresFix"}})],1),e.settings.useHiresFix?t("div",{staticClass:"hires-fix-settings"},[t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("高清修复步数")]),t("div",{staticClass:"setting-control"},[t("el-input-number",{attrs:{min:1,max:50,step:1,size:"small"},model:{value:e.settings.hiresSteps,callback:function(t){e.$set(e.settings,"hiresSteps",t)},expression:"settings.hiresSteps"}})],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("去噪强度")]),t("div",{staticClass:"setting-control"},[t("el-slider",{attrs:{min:0,max:1,step:.05},model:{value:e.settings.hiresDenoisingStrength,callback:function(t){e.$set(e.settings,"hiresDenoisingStrength",t)},expression:"settings.hiresDenoisingStrength"}})],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("放大倍数")]),t("div",{staticClass:"setting-control"},[t("el-select",{attrs:{placeholder:"选择放大倍数"},model:{value:e.settings.upscaler,callback:function(t){e.$set(e.settings,"upscaler",t)},expression:"settings.upscaler"}},[t("el-option",{attrs:{label:"1.5x",value:1.5}}),t("el-option",{attrs:{label:"2x",value:2}})],1)],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("缩放宽度")]),t("div",{staticClass:"setting-control"},[t("el-input-number",{attrs:{min:e.settings.width,max:2048,step:64,size:"small"},model:{value:e.settings.resizedWidth,callback:function(t){e.$set(e.settings,"resizedWidth",t)},expression:"settings.resizedWidth"}})],1)]),t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("缩放高度")]),t("div",{staticClass:"setting-control"},[t("el-input-number",{attrs:{min:e.settings.height,max:2048,step:64,size:"small"},model:{value:e.settings.resizedHeight,callback:function(t){e.$set(e.settings,"resizedHeight",t)},expression:"settings.resizedHeight"}})],1)])]):e._e()]),t("div",{staticClass:"advanced-settings-toggle"},[t("div",{staticClass:"section-header"},[t("h3",[e._v("高级设置")]),t("el-switch",{model:{value:e.showAdvancedSettings,callback:function(t){e.showAdvancedSettings=t},expression:"showAdvancedSettings"}})],1),e.showAdvancedSettings?t("div",{staticClass:"advanced-settings"},[t("div",{staticClass:"section-content"},[t("div",{staticClass:"setting-row"},[t("div",{staticClass:"setting-label"},[e._v("面部修复")]),t("div",{staticClass:"setting-control"},[t("el-switch",{on:{change:e.updateTokenUsage},model:{value:e.settings.faceRestoration,callback:function(t){e.$set(e.settings,"faceRestoration",t)},expression:"settings.faceRestoration"}}),e.settings.faceRestoration?t("span",{staticClass:"restore-face-hint"},[e._v("将应用面部修复")]):e._e()],1)])])]):e._e()])]),t("div",{staticClass:"generate-button-section"},[t("div",{staticClass:"token-info"},[t("div",{staticClass:"token-count"},[t("span",[e._v("预计消耗积分: "),t("b",[e._v(e._s(e.totalTokens))])]),t("el-tooltip",{attrs:{content:"积分消耗根据图像分辨率、步数和批次计算",placement:"top"}},[t("i",{staticClass:"el-icon-question"})])],1),t("div",{staticClass:"user-tokens"},[t("span",[e._v("可用积分: "),t("b",[e._v(e._s(e.userTokens))])]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.openBuyTokens}},[e._v("购买积分")])],1)]),t("generate-button",{attrs:{"token-cost":e.totalTokens,"token-balance":e.userTokens,"is-generating":e.isGenerating,"generation-progress":e.generationProgress,"can-generate":e.canGenerate,"progress-text":e.progressText||"生成中...","show-stop-button":!0,"is-vip-user":e.isVipUser},on:{generate:e.handleGenerate,stop:e.handleStop,recharge:e.openBuyTokens,"open-vip":e.openVipOptions}}),e.isVipUser?e._e():t("div",{staticClass:"generation-limits"},[t("p",[e._v("免费用户每天限制生成 "+e._s(e.freeUserDailyLimit)+" 张图片 "),t("el-button",{attrs:{type:"text"},on:{click:e.openVipOptions}},[e._v("升级会员解锁更多")])],1)])],1)]),t("div",{staticClass:"image-preview-panel"},[t("div",{staticClass:"preview-header"},[t("h3",{staticClass:"preview-title"},[e._v("生成预览")]),e.generatedImages.length>0?t("div",{staticClass:"preview-actions"},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-download"},on:{click:e.saveAllImages}},[e._v("保存所有")]),t("el-button",{attrs:{size:"small",icon:"el-icon-delete"},on:{click:e.clearResults}},[e._v("清除结果")])],1):e._e()]),t("div",{staticClass:"preview-content"},[0===e.generatedImages.length?t("div",{staticClass:"empty-preview"},[e._m(1)]):t("div",{staticClass:"image-grid"},e._l(e.generatedImages,(function(s,i){return t("div",{key:i,staticClass:"image-item"},[t("div",{staticClass:"image-container"},[t("img",{staticClass:"generated-image",attrs:{src:s.url,alt:"生成的图片"}})]),t("div",{staticClass:"image-actions"},[t("el-button",{attrs:{type:"text",icon:"el-icon-view"},on:{click:function(t){return e.handleImageClick(s)}}},[e._v("查看")]),t("el-button",{attrs:{type:"text",icon:"el-icon-download"},on:{click:function(t){return e.downloadImage(s)}}},[e._v("下载")]),t("el-button",{attrs:{type:"text",icon:"el-icon-star-off"},on:{click:function(t){return e.favoriteImage(s)}}},[e._v("收藏")])],1)])})),0)]),e.isGenerating?t("div",{staticClass:"generation-progress"},[t("el-progress",{attrs:{percentage:e.generationProgress,format:e.progressFormat}}),t("p",[e._v("正在生成图像，请稍等...")])],1):e._e()])]),t("el-dialog",{attrs:{title:"图片预览",visible:e.previewDialogVisible,width:"70%"},on:{"update:visible":function(t){e.previewDialogVisible=t}}},[e.currentPreviewImage?t("div",{staticClass:"preview-dialog-content"},[t("el-image",{attrs:{src:e.currentPreviewImage.url,alt:"预览图片",fit:"contain"}}),t("div",{staticClass:"preview-info"},[t("div",{staticClass:"info-section"},[t("h4",[e._v("提示词")]),t("p",[e._v(e._s(e.prompts.positive))])]),t("div",{staticClass:"info-section"},[t("h4",[e._v("反向提示词")]),t("p",[e._v(e._s(e.prompts.negative||"无"))])]),t("div",{staticClass:"info-section"},[t("h4",[e._v("参数")]),t("div",{staticClass:"params-grid"},[t("div",{staticClass:"param-item"},[t("span",{staticClass:"label"},[e._v("采样器")]),t("span",[e._v(e._s(e.settings.sampler))])]),t("div",{staticClass:"param-item"},[t("span",{staticClass:"label"},[e._v("步数")]),t("span",[e._v(e._s(e.settings.steps))])]),t("div",{staticClass:"param-item"},[t("span",{staticClass:"label"},[e._v("CFG Scale")]),t("span",[e._v(e._s(e.settings.cfgScale))])]),t("div",{staticClass:"param-item"},[t("span",{staticClass:"label"},[e._v("去噪强度")]),t("span",[e._v(e._s(e.settings.denoisingStrength))])]),t("div",{staticClass:"param-item"},[t("span",{staticClass:"label"},[e._v("种子")]),t("span",[e._v(e._s(e.currentPreviewImage.seed))])])])])])],1):e._e()]),t("el-dialog",{attrs:{title:"购买积分",visible:e.creditsDialog.visible,width:"40%"},on:{"update:visible":function(t){return e.$set(e.creditsDialog,"visible",t)}}},[t("div",{staticClass:"credit-packages"},e._l(e.creditPackages,(function(s,i){return t("div",{key:i,staticClass:"credit-package",class:{selected:e.creditsDialog.selectedPackage&&e.creditsDialog.selectedPackage.id===s.id},on:{click:function(t){return e.selectCreditPackage(s)}}},[t("div",{staticClass:"package-credits"},[e._v(e._s(s.amount)+"积分")]),t("div",{staticClass:"package-price"},[e._v("¥"+e._s(s.price))]),s.bonus?t("div",{staticClass:"package-info"},[t("el-tag",{attrs:{size:"mini",type:"success"}},[e._v("赠送"+e._s(s.bonus)+"积分")])],1):e._e()])})),0),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.creditsDialog.visible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary",disabled:!e.creditsDialog.selectedPackage},on:{click:e.confirmCreditPurchase}},[e._v(" 确认购买 ")])],1)])],1)},Qs=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"section-header"},[t("h3",[e._v("图像设置")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"empty-placeholder"},[t("i",{staticClass:"el-icon-picture-outline"}),t("p",[e._v('请上传图片并配置参数后点击"开始生成"按钮')])])}],Xs=function(){var e=this,t=e._self._c;return t("div",{staticClass:"image-uploader"},[t("div",{staticClass:"upload-area",class:{"is-dragover":e.isDragover,"has-image":e.hasImage},on:{dragover:function(t){t.preventDefault(),e.isDragover=!0},dragleave:function(t){t.preventDefault(),e.isDragover=!1},drop:function(t){return t.preventDefault(),e.onDrop.apply(null,arguments)},click:e.openFileDialog}},[t("input",{ref:"fileInput",staticClass:"file-input",attrs:{type:"file",accept:"image/*"},on:{change:e.handleFileChange}}),e.hasImage?t("div",{staticClass:"image-preview"},[t("img",{staticClass:"preview-img",attrs:{src:e.previewUrl,alt:"已上传图片"}}),t("div",{staticClass:"image-actions"},[t("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(t){return t.stopPropagation(),e.removeImage.apply(null,arguments)}}})],1)]):t("div",{staticClass:"upload-placeholder"},[e._m(0),t("div",{staticClass:"upload-text"},[t("p",{staticClass:"main-text"},[e._v(e._s(e.mainText))]),t("p",{staticClass:"sub-text"},[e._v(e._s(e.subText))])])])]),e.showSourceOptions&&e.hasImage?t("div",{staticClass:"source-controls"},[e.sourceButtons&&e.sourceButtons.length>0?t("div",{staticClass:"source-tabs"},[t("el-button-group",e._l(e.sourceButtons,(function(s,i){return t("el-button",{key:i,attrs:{size:"small",type:s.active?"primary":""},on:{click:function(t){return e.handleSourceButtonClick(s,i)}}},[e._v(" "+e._s(s.label)+" ")])})),1)],1):e._e()]):e._e()])},Ys=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"icon-wrapper"},[t("i",{staticClass:"el-icon-picture"})])}],Zs={name:"ImageUploader",props:{value:{type:[File,String,Object],default:null},mainText:{type:String,default:"将图像拖拽到这里 或 点击选择图片"},subText:{type:String,default:"请上传不超过5MB的图片，支持JPG、PNG格式"},showSourceOptions:{type:Boolean,default:!1},sourceButtons:{type:Array,default:()=>[]}},data(){return{isDragover:!1,previewUrl:"",file:null}},computed:{hasImage(){return!!this.previewUrl}},watch:{value:{immediate:!0,handler(e){e?e instanceof File?(this.file=e,this.createPreview(this.file)):"string"===typeof e?this.previewUrl=e:e.url&&(this.previewUrl=e.url):(this.previewUrl="",this.file=null)}}},methods:{openFileDialog(){this.$refs.fileInput.click()},onDrop(e){this.isDragover=!1;const t=e.dataTransfer.files;t.length>0&&this.processFile(t[0])},handleFileChange(e){const t=e.target.files;t.length>0&&this.processFile(t[0])},processFile(e){e.type.match("image.*")?e.size>5242880?this.$message.error("图片大小不能超过5MB"):(this.file=e,this.createPreview(e),this.$emit("input",e),this.$emit("change",e),this.$refs.fileInput.value=""):this.$message.error("请上传图片文件")},createPreview(e){const t=new FileReader;t.onload=e=>{this.previewUrl=e.target.result},t.readAsDataURL(e)},removeImage(e){e.stopPropagation(),this.previewUrl="",this.file=null,this.$emit("input",null),this.$emit("change",null),this.$emit("remove")},handleSourceButtonClick(e,t){this.$emit("source-button-click",{button:e,index:t})}}},ei=Zs,ti=(0,Fs.A)(ei,Xs,Ys,!1,null,"29ccf0f2",null),si=ti.exports,ii={name:"ImageToImageTab",components:{GenerateButton:Ls,ImageUploader:si},data(){return{generateId:"",taskId:"",sourceImage:"https://images.unsplash.com/photo-1506744038136-46273834b3fb",isGenerating:!1,generationProgress:0,progressText:"生成中...",generatedImages:[],modelList:[],templateList:[],samplerList:[{label:"Euler a",value:0},{label:"Euler",value:1},{label:"LMS",value:2},{label:"Heun",value:3},{label:"DPM2",value:4},{label:"DPM2 a",value:5},{label:"DPM++ 2S a",value:6},{label:"DPM++ 2M",value:7},{label:"DPM++ SDE",value:8},{label:"DPM fast",value:9},{label:"DPM adaptive",value:10},{label:"LMS Karras",value:11},{label:"DPM2 Karras",value:12},{label:"DPM2 a Karras",value:13},{label:"DPM++ 2S a Karras",value:14},{label:"DPM++ 2M Karras",value:15},{label:"DPM++ SDE Karras",value:16},{label:"DDIM",value:17},{label:"PLMS",value:18}],upscalerList:[{label:"ESRGAN_4x",value:"esrgan_4x"},{label:"R-ESRGAN 4x+",value:"r_esrgan_4x_plus"},{label:"LDSR",value:"ldsr"}],clipSkipValue:1,currentGenerateTask:{generateId:null,taskId:null},settings:{imgCount:1,width:512,height:512,mode:0,model:"",template:"",sampler:0,steps:30,cfgScale:7,seed:-1,batchSize:1,denoisingStrength:.75,useClipSkip:!1,faceRestoration:!1,useHiresFix:!1,hiresSteps:20,hiresDenoisingStrength:.7,upscaler:"esrgan_4x",resizedWidth:768,resizedHeight:768,painting:{limits:{minSize:256,maxSize:1024,minSteps:1,maxSteps:150,minCfgScale:1,maxCfgScale:30,minBatchSize:1,maxBatchSize:4,minUpscaleScale:1,maxUpscaleScale:4}}},prompts:{positive:"",negative:""},showAdvancedSettings:!1,previewDialogVisible:!1,currentPreviewImage:null,isVipUser:!1,userTokens:50,freeUserDailyLimit:3,creditsDialog:{visible:!1,selectedPackage:null},creditPackages:[{id:1,amount:100,price:10,bonus:10},{id:2,amount:200,price:18,bonus:20},{id:3,amount:500,price:40,bonus:50},{id:4,amount:1e3,price:70,bonus:100}]}},computed:{canGenerate(){return!this.isGenerating&&this.sourceImage&&""!==this.sourceImage&&""!==this.prompts.positive.trim()&&""!==this.settings.model&&""!==this.settings.template&&this.userTokens>=this.totalTokens},totalTokens(){return c({width:512,height:512,steps:this.settings.steps,batchSize:this.settings.imgCount,model:this.settings.model,upscale:this.settings.useHiresFix,faceRestore:this.settings.faceRestoration,denoisingStrength:this.settings.denoisingStrength})}},mounted(){this.getModelList()},methods:{getModelList(){Vs().then((e=>{const t=e.data,s=t.filter((e=>0===e.type)),i=s.map((e=>({label:e.modelName,value:e.modelUuid,description:e.modelVersion||""}))),a=t.filter((e=>2===e.type)),n=a.map((e=>e.modelName.includes("图生图")?{label:e.modelName,value:e.modelUuid,description:e.modelVersion||""}:null)).filter((e=>null!==e)),o={label:"星流start",value:"0",description:"默认模型"};this.modelList=i,this.templateList=n,this.templateList.unshift(o),console.log("获取到的模型列表:",this.modelList),console.log("获取到的模板列表:",this.templateList),i.length>0&&(this.settings.model=i[0].value),n.length>0&&(this.settings.template=n[0].value)})).catch((e=>{console.error("获取模型和模板列表失败",e),this.$message.error("获取模型和模板列表失败: "+(e.message||"未知错误")),this.modelList=[{label:"默认模型",value:"default_model",description:"预设模型"}],this.templateList=[{label:"默认模板",value:"default_template",description:"预设模板"}],this.settings.model="default_model",this.settings.template="default_template"}))},handleImageUpload(e){console.log("Image uploaded:",e),this.sourceImage=e},async handleGenerate(){if(localStorage.getItem("token"))if(this.sourceImage)if(this.prompts.positive){this.isGenerating=!0,this.generationProgress=0,this.progressText="准备生成...";try{const e=this.prompts.positive,t=this.settings.imgCount,s=this.settings.denoisingStrength;if("0"===this.settings.template){console.log("使用星流start模板生成图片");const s={prompt:e,imgCount:t,sourceImage:this.sourceImage,width:this.settings.width,height:this.settings.height};console.log("星流start请求参数:",s);const i=await js(s);if(console.log("星流start响应:",i),!i.data||!i.data.taskId)throw new Error("获取任务ID失败");this.taskId=i.data.taskId,this.generateId=i.data.generateId,this.progressText="开始生成...",await this.pollGenerationResult()}else{const i=-1===this.settings.seed?null:this.settings.seed,a=this.prepareImageToImageParams(e,i,t,s);console.log("普通请求参数:",a);const n=await Es.post("/api/image/customize/image-to-image",a);if(!n.data||!n.data.taskId)throw new Error("获取任务ID失败");this.taskId=n.data.taskId,this.generateId=n.data.generateId,this.progressText="开始生成...",await this.pollGenerationResult()}}catch(e){console.error("生成失败:",e),this.$message.error("图片生成失败，请稍后再试"),this.isGenerating=!1,this.progressText="生成失败"}}else this.$message.warning("请输入提示词");else this.$message.warning("请上传源图片");else this.$message.warning("请先登录")},async pollGenerationResult(){try{const e=await Es.get("/api/image/get-images?&taskId="+this.taskId);if(!e)throw new Error(e?.message||"获取生成结果失败");if(1===e.data.percentCompleted)return this.generatedImages=e.data.images.map(((e,t)=>({url:e.imageUrl,seed:-1===this.settings.seed?`生成的随机种子_${t}`:this.settings.seed}))),this.userTokens-=this.totalTokens,this.$message.success("图像生成成功"),this.isGenerating=!1,void(this.progressText="生成完成");if(void 0!==e.data.percentCompleted){this.generationProgress=100*e.data.percentCompleted;const t=Math.floor(100*e.data.percentCompleted);this.progressText=`生成中... ${t}%`}setTimeout((()=>this.pollGenerationResult()),2e3)}catch(e){console.error("获取生成结果失败",e),this.$message.error("获取生成结果失败: "+(e.message||"未知错误")),this.isGenerating=!1,this.progressText="生成失败"}},async handleStop(){try{this.generateId&&this.taskId&&await Es.post("/api/image/cancel-task",{generateId:this.generateId,taskId:this.taskId}),this.isGenerating=!1,this.generationProgress=0,this.progressText="已停止生成",this.$message.info("已停止生成")}catch(e){console.error("停止生成失败",e),this.$message.error("停止失败: "+(e.message||"未知错误"))}},clearResults(){this.generatedImages=[],this.$message.success("已清除所有结果")},handleImageClick(e){this.currentPreviewImage=e,this.previewDialogVisible=!0},openBuyTokens(){this.creditsDialog.visible=!0},openVipOptions(){this.$message.info("VIP会员功能正在开发中...")},saveAllImages(){0!==this.generatedImages.length?(this.generatedImages.forEach(((e,t)=>{this.downloadImage(e,`generated_image_${t+1}`)})),this.$message.success("所有图像已开始下载")):this.$message.warning("没有可保存的图像")},downloadImage(e,t="generated_image"){const s=document.createElement("a");s.href=e.url,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)},progressFormat(e){return`${e}%`},translatePrompt(){this.prompts.positive?this.$message.info("翻译功能正在开发中..."):this.$message.warning("请先输入提示词")},useDefaultNegativePrompt(){this.prompts.negative="low quality, bad anatomy, worst quality, blurry, distorted face, bad proportions, deformed, ugly, disfigured",this.$message.info("已使用默认负向提示词")},showPromptLibrary(){this.$message.info("提示词库功能正在开发中...")},showNegativeLibrary(){this.$message.info("负向提示词库功能正在开发中...")},refreshModels(){this.$message.info("正在刷新模型和模板列表..."),this.getModelList()},updateTokenUsage(){console.log("更新积分消耗")},randomizeSeed(){this.settings.seed=d(),this.$message.info(`已生成随机种子: ${this.settings.seed}`)},favoriteImage(e){this.$message.success("图片已添加到收藏夹")},prepareImageToImageParams(e,t,s,i){return{templateUuid:this.settings.template,checkPointId:this.settings.model,prompt:e,negativePrompt:this.prompts.negative||"",sampler:this.settings.sampler,steps:this.settings.steps,cfgScale:this.settings.cfgScale,resizedWidth:this.settings.width||512,resizedHeight:this.settings.height||512,imgCount:s,seed:t,denoisingStrength:i,mode:this.settings.mode,clipSkip:this.settings.useClipSkip?this.clipSkipValue:null,restoreFaces:this.settings.faceRestoration?1:0,hiResFixInfoPojo:this.settings.useHiresFix?{hiresSteps:this.settings.hiresSteps,hiresDenoisingStrength:this.settings.hiresDenoisingStrength,upscaler:this.settings.upscaler,resizedWidth:this.settings.resizedWidth||768,resizedHeight:this.settings.resizedHeight||768}:null,sourceImage:this.sourceImage,userId:1}},selectCreditPackage(e){this.creditsDialog.selectedPackage=e},confirmCreditPurchase(){if(!this.creditsDialog.selectedPackage)return;const e=this.creditsDialog.selectedPackage;this.userTokens+=e.amount+(e.bonus||0),this.$message.success(`您已成功购买${e.amount}积分${e.bonus?"，赠送"+e.bonus+"积分":""}！`),this.creditsDialog.visible=!1,this.creditsDialog.selectedPackage=null},validateSize(){this.settings.width%64===0&&this.settings.height%64===0||(this.settings.width=64*Math.round(this.settings.width/64),this.settings.height=64*Math.round(this.settings.height/64),this.$message.warning("尺寸已调整为64的倍数")),this.settings.useHiresFix&&(this.settings.resizedWidth<this.settings.width&&(this.settings.resizedWidth=this.settings.width),this.settings.resizedHeight<this.settings.height&&(this.settings.resizedHeight=this.settings.height))}}},ai=ii,ni=(0,Fs.A)(ai,Js,Qs,!1,null,"02a8179b",null),oi=ni.exports,ri=function(){var e=this,t=e._self._c;return t("div",{staticClass:"post-processing-tab"},[e._m(0),t("div",{staticClass:"main-container"},[t("div",{staticClass:"left-panel"},[t("div",{staticClass:"control-section"},[t("h3",{staticClass:"section-title"},[e._v("图片上传")]),t("image-uploader",{on:{change:e.handleImageChange},model:{value:e.sourceImage,callback:function(t){e.sourceImage=t},expression:"sourceImage"}})],1),t("div",{staticClass:"control-section"},[t("h3",{staticClass:"section-title"},[e._v("放大设置")]),t("div",{staticClass:"setting-item"},[t("label",[e._v("放大倍数")]),t("el-tooltip",{attrs:{content:"选择图像放大的倍数",placement:"top"}},[t("i",{staticClass:"el-icon-question"})]),t("el-input-number",{staticClass:"full-width",attrs:{min:1,max:4,step:.5,precision:1},model:{value:e.resizeFactor,callback:function(t){e.resizeFactor=t},expression:"resizeFactor"}})],1),e.sourceImage?t("div",{staticClass:"resize-info"},[t("span",[e._v("从 "+e._s(e.originalWidth)+"*"+e._s(e.originalHeight)+" 放大到 "+e._s(Math.round(e.originalWidth*e.resizeFactor))+"*"+e._s(Math.round(e.originalHeight*e.resizeFactor)))])]):e._e()]),t("div",{staticClass:"control-section"},[t("h3",{staticClass:"section-title"},[e._v("图像增强")]),t("div",{staticClass:"enhancement-option"},[t("div",{staticClass:"option-header"},[t("el-checkbox",{model:{value:e.enableEnhancement,callback:function(t){e.enableEnhancement=t},expression:"enableEnhancement"}},[e._v("全面增强 Enhance")])],1),e.enableEnhancement?t("div",{staticClass:"slider-with-value"},[t("el-slider",{attrs:{min:0,max:1,step:.1},model:{value:e.enhancementStrength,callback:function(t){e.enhancementStrength=t},expression:"enhancementStrength"}}),t("span",{staticClass:"value-display"},[e._v(e._s(e.enhancementStrength))])],1):e._e()]),t("div",{staticClass:"enhancement-option"},[t("div",{staticClass:"option-header"},[t("el-checkbox",{model:{value:e.faceRestore,callback:function(t){e.faceRestore=t},expression:"faceRestore"}},[e._v("面部修复")])],1),e.faceRestore?t("div",{staticClass:"face-restore-settings"},[t("label",[e._v("面部模糊度：")]),t("el-slider",{attrs:{min:0,max:8,step:1},model:{value:e.faceRestoreBlur,callback:function(t){e.faceRestoreBlur=t},expression:"faceRestoreBlur"}})],1):e._e()]),t("div",{staticClass:"enhancement-option"},[e._m(1),t("el-slider",{attrs:{min:0,max:1,step:.1},model:{value:e.sharpness,callback:function(t){e.sharpness=t},expression:"sharpness"}})],1),t("div",{staticClass:"enhancement-option"},[e._m(2),t("el-slider",{attrs:{min:0,max:1,step:.1},model:{value:e.denoiseStrength,callback:function(t){e.denoiseStrength=t},expression:"denoiseStrength"}})],1),e.isVipUser||!e.enableEnhancement&&!e.faceRestore?e._e():t("div",{staticClass:"vip-notice"},[t("el-alert",{attrs:{title:"需要VIP会员权限",type:"warning",closable:!1}},[t("template",{slot:"title"},[e._v(" 高级增强和面部修复功能需要VIP会员权限 "),t("el-button",{attrs:{type:"text",size:"small"},on:{click:e.openVipOptions}},[e._v("立即开通")])],1)],2)],1)]),t("div",{staticClass:"control-section"},[t("h3",{staticClass:"section-title"},[e._v("放大算法")]),t("div",{staticClass:"setting-item"},[t("label",[e._v("Upscaler 1")]),t("el-select",{staticClass:"full-width",attrs:{placeholder:"选择主要放大算法"},model:{value:e.upscaler1,callback:function(t){e.upscaler1=t},expression:"upscaler1"}},e._l(e.upscalerOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("div",{staticClass:"setting-item"},[t("label",[e._v("Upscaler 2")]),t("div",{staticClass:"upscaler-with-weight"},[t("el-select",{staticStyle:{width:"70%"},attrs:{placeholder:"选择次要放大算法"},model:{value:e.upscaler2,callback:function(t){e.upscaler2=t},expression:"upscaler2"}},e._l(e.upscalerOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("div",{staticClass:"weight-slider",staticStyle:{width:"30%"}},[t("el-slider",{attrs:{min:0,max:1,step:.1},model:{value:e.upscaler2Weight,callback:function(t){e.upscaler2Weight=t},expression:"upscaler2Weight"}})],1)],1)])]),t("div",{staticClass:"control-section"},[t("div",{staticClass:"token-info"},[t("div",{staticClass:"token-count"},[t("span",[e._v("预计消耗积分: "),t("b",[e._v(e._s(e.totalTokens))])]),t("el-tooltip",{attrs:{content:"积分消耗根据图像尺寸和处理类型计算",placement:"top"}},[t("i",{staticClass:"el-icon-question"})])],1),t("div",{staticClass:"user-tokens"},[t("span",[e._v("可用积分: "),t("b",[e._v(e._s(e.userTokens))])]),t("el-button",{attrs:{type:"text",size:"mini"},on:{click:e.openBuyTokens}},[e._v("购买积分")])],1)]),t("generate-button",{attrs:{"token-cost":e.totalTokens,"token-balance":e.userTokens,"is-generating":e.isProcessing,"generation-progress":e.processingProgress,"can-generate":e.canProcess&&!(!e.isVipUser&&(e.enableEnhancement||e.faceRestore)),"progress-text":e.progressText||"处理中...","show-stop-button":!0,"is-vip-user":e.isVipUser},on:{generate:e.processImage,stop:e.stopProcessing,recharge:e.openBuyTokens,"open-vip":e.openVipOptions}})],1)]),t("div",{staticClass:"right-panel"},[t("div",{staticClass:"preview-panel"},[t("div",{staticClass:"preview-header"},[t("h3",{staticClass:"panel-title"},[e._v("处理结果预览")]),e.processedImages.length>0?t("div",{staticClass:"preview-actions"},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-download"},on:{click:e.saveAllImages}},[e._v("保存所有")]),t("el-button",{attrs:{size:"small",icon:"el-icon-delete"},on:{click:e.clearResults}},[e._v("清除结果")])],1):e._e()]),t("div",{staticClass:"preview-content"},[e.processedImages.length>0?t("div",{staticClass:"image-grid"},e._l(e.processedImages,(function(s,i){return t("div",{key:i,staticClass:"image-item"},[t("div",{staticClass:"image-container"},[t("img",{staticClass:"generated-image",attrs:{src:s.url,alt:"处理后的图片"}})]),t("div",{staticClass:"image-actions"},[t("el-button",{attrs:{type:"text",icon:"el-icon-view"},on:{click:function(t){return e.previewImage(s)}}},[e._v("查看")]),t("el-button",{attrs:{type:"text",icon:"el-icon-download"},on:{click:function(t){return e.downloadImage(s)}}},[e._v("下载")]),t("el-button",{attrs:{type:"text",icon:"el-icon-star-off"},on:{click:function(t){return e.favoriteImage(s)}}},[e._v("收藏")])],1)])})),0):t("div",{staticClass:"empty-preview"},[e._m(3)])]),e.isProcessing?t("div",{staticClass:"generation-progress"},[t("el-progress",{attrs:{percentage:e.processingProgress,format:e.progressFormat}}),t("p",[e._v("正在处理图像中，请稍等...")])],1):e._e()])])])])},li=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"tab-header"},[t("h2",{staticClass:"tab-title"},[e._v("图像后期处理")]),t("p",{staticClass:"tab-description"},[e._v("对图像进行后期增强、优化和处理")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"option-header"},[t("label",[e._v("清晰度增强")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"option-header"},[t("label",[e._v("降噪强度")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"empty-placeholder"},[t("i",{staticClass:"el-icon-picture-outline"}),t("p",[e._v("请上传图片并配置处理参数，然后点击生成按钮")])])}],ci={name:"PostProcessingTab",components:{ImageUploader:si,GenerateButton:Ls},data(){return{sourceImage:null,originalWidth:512,originalHeight:512,resizeFactor:2,enableEnhancement:!1,enhancementStrength:.5,faceRestore:!1,faceRestoreBlur:4,sharpness:.3,denoiseStrength:.5,upscaler1:"R-ESRGAN 4x+",upscaler2:"None",upscaler2Weight:.5,isProcessing:!1,loadingDialog:!1,processingProgress:0,progressText:"正在处理...",processedImages:[],previewDialog:!1,currentPreviewImage:null,isVipUser:!1,userTokens:50,upscalerOptions:p()}},computed:{canProcess(){return null!==this.sourceImage&&this.userTokens>=this.totalTokens},totalTokens(){let e=5;return this.faceRestore&&(e+=3),this.resizeFactor>1&&(e+=Math.ceil(5*this.resizeFactor)),e}},methods:{handleImageChange(e){e&&(this.originalWidth=512,this.originalHeight=512)},async processImage(e){this.canProcess&&(this.isVipUser||!this.enableEnhancement&&!this.faceRestore)?(this.isProcessing=!0,this.loadingDialog=!0,this.processingProgress=0,this.progressText=e&&"vip"===e.queueType?"VIP优先处理中...":"普通队列处理中...",g((e=>{this.processingProgress=e}),e&&"vip"===e.queueType?2e3:6e3).then((()=>{const e={id:Date.now(),url:`https://picsum.photos/seed/${Math.floor(1e3*Math.random())}/512/512`,originalImage:this.sourceImage,settings:{resizeFactor:this.resizeFactor,enableEnhancement:this.enableEnhancement,enhancementStrength:this.enhancementStrength,faceRestore:this.faceRestore,faceRestoreBlur:this.faceRestoreBlur,sharpness:this.sharpness,denoiseStrength:this.denoiseStrength,upscaler1:this.upscaler1,upscaler2:this.upscaler2,upscaler2Weight:this.upscaler2Weight},timestamp:(new Date).toISOString()};this.processedImages.unshift(e),this.isProcessing=!1,this.loadingDialog=!1,this.userTokens-=this.totalTokens,this.$message.success("图像处理完成")})).catch((e=>{this.$message.error("处理失败："+e.message),this.isProcessing=!1,this.loadingDialog=!1}))):this.isVipUser||!this.enableEnhancement&&!this.faceRestore||this.openVipOptions()},progressFormat(e){return e+"%"},previewImage(e){this.currentPreviewImage=e,this.$message.info("图像预览功能开发中")},downloadImage(e){this.$message.success(`图像${e.id}已下载`)},favoriteImage(e){this.$message.success(`图像${e.id}已添加到收藏`)},saveAllImages(){this.$message.success("所有图像已保存")},clearResults(){this.processedImages=[]},openVipOptions(){this.$message.info("开通VIP会员功能开发中")},openBuyTokens(){this.$message.info("购买积分功能开发中")},stopProcessing(){this.isProcessing=!1,this.loadingDialog=!1,this.processingProgress=0,this.progressText="处理已停止"}}},di=ci,ui=(0,Fs.A)(di,ri,li,!1,null,"cd62fec8",null),pi=ui.exports,gi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"upscale-tab"},[e._m(0),t("div",{staticClass:"main-container"},[t("div",{staticClass:"left-panel"},[t("div",{staticClass:"control-section"},[t("h3",{staticClass:"section-title"},[e._v("图片上传")]),t("image-uploader",{on:{change:e.handleImageChange},model:{value:e.sourceImage,callback:function(t){e.sourceImage=t},expression:"sourceImage"}})],1),t("div",{staticClass:"control-section"},[t("h3",{staticClass:"section-title"},[e._v("尺寸设置")]),t("div",{staticClass:"size-inputs"},[t("div",{staticClass:"input-group"},[t("label",[e._v("宽度 Width")]),t("el-input",{attrs:{type:"number",min:64,max:4096,step:64},model:{value:e.width,callback:function(t){e.width=e._n(t)},expression:"width"}})],1),t("div",{staticClass:"input-group"},[t("label",[e._v("高度 Height")]),t("el-input",{attrs:{type:"number",min:64,max:4096,step:64},model:{value:e.height,callback:function(t){e.height=e._n(t)},expression:"height"}})],1)]),e.sourceImage?t("div",{staticClass:"size-info"},[t("span",[e._v("从 "+e._s(e.originalWidth)+"*"+e._s(e.originalHeight)+" 缩放到 "+e._s(e.width)+"*"+e._s(e.height))])]):e._e()]),t("div",{staticClass:"control-section"},[t("h3",{staticClass:"section-title"},[e._v("Upscaler设置")]),t("div",{staticClass:"setting-item"},[t("label",[e._v("Upscaler1")]),t("el-select",{staticClass:"full-width",model:{value:e.upscaler1,callback:function(t){e.upscaler1=t},expression:"upscaler1"}},e._l(e.upscalerOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),t("div",{staticClass:"setting-item"},[t("label",[e._v("放大方法")]),t("el-select",{staticClass:"full-width",attrs:{placeholder:"选择放大方法"},model:{value:e.upscaleMethod,callback:function(t){e.upscaleMethod=t},expression:"upscaleMethod"}},[t("el-option",{attrs:{label:"R-ESRGAN 4x+",value:"R-ESRGAN_4x"}}),t("el-option",{attrs:{label:"Lanczos",value:"Lanczos"}})],1)],1),t("div",{staticClass:"setting-item"},[t("label",[e._v("放大系数")]),t("el-input-number",{staticClass:"full-width",attrs:{min:1,max:8,step:.5},model:{value:e.upscaleFactor,callback:function(t){e.upscaleFactor=t},expression:"upscaleFactor"}})],1)]),t("div",{staticClass:"control-section"},[t("h3",{staticClass:"section-title"},[e._v("面部修复")]),t("div",{staticClass:"setting-item"},[t("label",[e._v("GFPGAN强度")]),t("div",{staticClass:"slider-with-value"},[t("el-slider",{attrs:{min:0,max:1,step:.01},model:{value:e.gfpganStrength,callback:function(t){e.gfpganStrength=t},expression:"gfpganStrength"}}),t("span",{staticClass:"value-display"},[e._v(e._s(e.gfpganStrength.toFixed(2)))])],1)]),t("div",{staticClass:"setting-item"},[t("label",[e._v("CodeFormer强度")]),t("div",{staticClass:"slider-with-value"},[t("el-slider",{attrs:{min:0,max:1,step:.01},model:{value:e.codeformerStrength,callback:function(t){e.codeformerStrength=t},expression:"codeformerStrength"}}),t("span",{staticClass:"value-display"},[e._v(e._s(e.codeformerStrength.toFixed(2)))])],1)]),t("div",{staticClass:"checkbox-option"},[t("el-checkbox",{model:{value:e.cropToFit,callback:function(t){e.cropToFit=t},expression:"cropToFit"}},[e._v("裁剪以适应")])],1)]),t("div",{staticClass:"control-section"},[t("generate-button",{attrs:{"token-cost":e.creditCount,"token-balance":e.userTokens||50,"is-generating":e.isProcessing,"generation-progress":e.processingProgress,"can-generate":e.canProcess,"progress-text":e.progressText||"处理中...","show-stop-button":!0,"is-vip-user":e.isVipUser},on:{generate:e.processImage,stop:e.stopProcessing,recharge:e.openBuyTokens,"open-vip":e.openVipDialog}})],1)]),t("div",{staticClass:"right-panel"},[t("div",{staticClass:"preview-panel"},[t("div",{staticClass:"preview-header"},[t("h3",{staticClass:"panel-title"},[e._v("放大结果预览")]),e.processedImages.length>0?t("div",{staticClass:"preview-actions"},[t("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-download"},on:{click:e.saveAllImages}},[e._v("保存所有")]),t("el-button",{attrs:{size:"small",icon:"el-icon-delete"},on:{click:e.clearResults}},[e._v("清除结果")])],1):e._e()]),t("div",{staticClass:"preview-content"},[e.processedImages.length>0?t("div",{staticClass:"image-grid"},e._l(e.processedImages,(function(s,i){return t("div",{key:i,staticClass:"image-item"},[t("div",{staticClass:"image-container"},[t("img",{staticClass:"generated-image",attrs:{src:s.url||`https://picsum.photos/seed/${Math.floor(1e3*Math.random())}/512/512`,alt:"放大后的图片"}})]),t("div",{staticClass:"image-actions"},[t("el-button",{attrs:{type:"text",icon:"el-icon-view"},on:{click:function(t){return e.previewImage(s)}}},[e._v("查看")]),t("el-button",{attrs:{type:"text",icon:"el-icon-download"},on:{click:function(t){return e.downloadImage(s)}}},[e._v("下载")]),t("el-button",{attrs:{type:"text",icon:"el-icon-star-off"},on:{click:function(t){return e.favoriteImage(s)}}},[e._v("收藏")])],1)])})),0):t("div",{staticClass:"empty-preview"},[e._m(1)])]),e.isProcessing?t("div",{staticClass:"generation-progress"},[t("el-progress",{attrs:{percentage:e.processingProgress,format:e.progressFormat}}),t("p",[e._v("正在处理图像中，请稍等...")])],1):e._e()])])])])},hi=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"tab-header"},[t("h2",{staticClass:"tab-title"},[e._v("超清放大 (Tiled diffusion)")]),t("p",{staticClass:"tab-description"},[e._v("使用Tiled diffusion技术对图像进行超清分辨率处理")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"empty-placeholder"},[t("i",{staticClass:"el-icon-picture-outline"}),t("p",[e._v("请上传图片并配置放大参数，然后点击生成按钮")])])}],mi={name:"UpscaleTab",components:{ImageUploader:si,GenerateButton:Ls},data(){return{sourceImage:null,originalWidth:512,originalHeight:512,width:1024,height:1024,upscaler1:"Lanczos",upscaleMethod:"R-ESRGAN_4x",upscaleFactor:2,gfpganStrength:0,codeformerStrength:0,cropToFit:!1,isProcessing:!1,loadingDialog:!1,processingProgress:0,progressText:"处理中...",processedImages:[],upscalerOptions:[{value:"Lanczos",label:"Lanczos"},{value:"R-ESRGAN 4x+",label:"R-ESRGAN 4x+"},{value:"LDSR",label:"LDSR"},{value:"SwinIR",label:"SwinIR"}],isVipUser:!1,userTokens:50}},computed:{canProcess(){return null!==this.sourceImage},creditCount(){const e=5,t=this.width*this.height/1048576,s=Math.ceil(10*t);return e+s}},methods:{handleImageChange(e){e&&(this.originalWidth=512,this.originalHeight=512,this.width=2*this.originalWidth,this.height=2*this.originalHeight)},async processImage(e){this.canProcess&&(this.isProcessing=!0,this.loadingDialog=!0,this.processingProgress=0,this.progressText=e&&"vip"===e.queueType?"VIP优先处理中...":"普通队列处理中...",g((e=>{this.processingProgress=e}),e&&"vip"===e.queueType?3e3:8e3).then((()=>{const e={id:Date.now(),url:`https://picsum.photos/seed/${Math.floor(1e3*Math.random())}/${this.width}/${this.height}`,sourceImage:this.sourceImage,settings:{width:this.width,height:this.height,upscaler1:this.upscaler1,upscaleMethod:this.upscaleMethod,upscaleFactor:this.upscaleFactor,gfpganStrength:this.gfpganStrength,codeformerStrength:this.codeformerStrength,cropToFit:this.cropToFit},timestamp:(new Date).toISOString()};this.processedImages.unshift(e),this.isProcessing=!1,this.loadingDialog=!1,this.userTokens-=this.creditCount,this.$message.success("图像超清放大完成")})).catch((e=>{this.$message.error("处理失败："+e.message),this.isProcessing=!1,this.loadingDialog=!1})))},stopProcessing(){this.isProcessing=!1,this.loadingDialog=!1,this.$message.info("处理已停止")},previewImage(){this.$message.info("查看图片预览")},downloadImage(){this.$message.success("图片已下载")},favoriteImage(){this.$message.success("已添加到收藏")},saveAllImages(){this.$message.success(`已下载 ${this.processedImages.length} 张图片`)},clearResults(){this.processedImages=[],this.$message.info("已清除所有结果")},openBuyTokens(){this.$message.info("购买积分功能开发中")},openVipDialog(){this.$message.info("VIP会员功能开发中")},progressFormat(e){return`${e}%`}}},vi=mi,fi=(0,Fs.A)(vi,gi,hi,!1,null,"51a55882",null),bi=fi.exports,Ci=function(){var e=this,t=e._self._c;return t("div",{staticClass:"gallery-tab"},[e._m(0),t("div",{staticClass:"filter-section"},[t("div",{staticClass:"search-box"},[t("el-input",{attrs:{placeholder:"搜索画作名称或标签","prefix-icon":"el-icon-search",clearable:""},on:{clear:e.resetSearch},model:{value:e.searchQuery,callback:function(t){e.searchQuery=t},expression:"searchQuery"}})],1),t("div",{staticClass:"filter-options"},[t("el-select",{attrs:{placeholder:"生成模型",clearable:""},on:{change:e.applyFilters},model:{value:e.modelFilter,callback:function(t){e.modelFilter=t},expression:"modelFilter"}},e._l(e.modelOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("el-select",{attrs:{placeholder:"创建时间",clearable:""},on:{change:e.applyFilters},model:{value:e.timeFilter,callback:function(t){e.timeFilter=t},expression:"timeFilter"}},e._l(e.timeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),t("el-select",{attrs:{placeholder:"排序方式"},on:{change:e.applyFilters},model:{value:e.sortOption,callback:function(t){e.sortOption=t},expression:"sortOption"}},e._l(e.sortOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]),e.filteredPaintings.length>0?t("div",{staticClass:"paintings-grid"},e._l(e.filteredPaintings,(function(s){return t("div",{key:s.id,staticClass:"painting-card",on:{click:function(t){return e.viewPaintingDetail(s.id)}}},[t("div",{staticClass:"painting-image",style:{backgroundImage:`url(${s.imageUrl})`}},[t("div",{staticClass:"painting-actions"},[t("el-button",{attrs:{type:"text",icon:"el-icon-download"},on:{click:function(t){return t.stopPropagation(),e.downloadImage(s)}}}),t("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(t){return t.stopPropagation(),e.editPrompt(s)}}}),t("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(t){return t.stopPropagation(),e.confirmDelete(s)}}})],1)]),t("div",{staticClass:"painting-info"},[t("h3",{staticClass:"painting-title"},[e._v(e._s(s.title||"未命名作品"))]),t("div",{staticClass:"painting-meta"},[t("span",{staticClass:"painting-date"},[e._v(e._s(e.formatDate(s.created)))]),t("span",{staticClass:"painting-model"},[e._v(e._s(s.model))])]),t("div",{staticClass:"painting-prompt"},[t("el-tooltip",{attrs:{content:s.prompt,placement:"top",disabled:!s.prompt}},[t("p",{staticClass:"truncate"},[e._v(e._s(s.prompt||"无提示词"))])])],1),s.tags&&s.tags.length?t("div",{staticClass:"painting-tags"},e._l(s.tags,(function(s){return t("el-tag",{key:s,attrs:{size:"mini"},on:{click:function(t){return t.stopPropagation(),e.filterByTag(s)}}},[e._v(e._s(s))])})),1):e._e()])])})),0):e._e(),e.selectedPaintings.length>0?t("div",{staticClass:"batch-actions"},[t("span",{staticClass:"selected-count"},[e._v("已选择 "+e._s(e.selectedPaintings.length)+" 项")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.batchDownload}},[e._v("批量下载")]),t("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.batchDelete}},[e._v("批量删除")]),t("el-button",{attrs:{size:"small"},on:{click:e.clearSelection}},[e._v("取消选择")])],1):e._e(),0===e.filteredPaintings.length?t("div",{staticClass:"no-results"},[t("i",{staticClass:"el-icon-picture-outline"}),t("h3",[e._v("暂无画作")]),t("p",[e._v("您还没有创建任何AI画作，或没有符合筛选条件的作品")]),t("el-button",{attrs:{type:"primary"},on:{click:e.goToCreate}},[e._v("开始创作")]),e.hasFilters?t("el-button",{attrs:{plain:""},on:{click:e.resetFilters}},[e._v("重置筛选")]):e._e()],1):e._e(),e.totalPaintings>e.pageSize?t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:e.totalPaintings,"current-page":e.currentPage,"page-size":e.pageSize},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.handlePageChange}})],1):e._e(),t("el-dialog",{attrs:{title:"编辑画作信息",visible:e.editDialog.visible,width:"50%"},on:{"update:visible":function(t){return e.$set(e.editDialog,"visible",t)}}},[e.editDialog.painting?t("div",{staticClass:"edit-dialog-content"},[t("el-form",{attrs:{"label-position":"top"}},[t("el-form-item",{attrs:{label:"标题"}},[t("el-input",{attrs:{placeholder:"为您的作品命名"},model:{value:e.editDialog.painting.title,callback:function(t){e.$set(e.editDialog.painting,"title",t)},expression:"editDialog.painting.title"}})],1),t("el-form-item",{attrs:{label:"提示词"}},[t("el-input",{attrs:{type:"textarea",rows:4,placeholder:"描述此画作的提示词"},model:{value:e.editDialog.painting.prompt,callback:function(t){e.$set(e.editDialog.painting,"prompt",t)},expression:"editDialog.painting.prompt"}})],1),t("el-form-item",{attrs:{label:"标签"}},[e._l(e.editDialog.tags,(function(s){return t("el-tag",{key:s,attrs:{closable:"","disable-transitions":!1},on:{close:function(t){return e.handleTagClose(s)}}},[e._v(" "+e._s(s)+" ")])})),e.editDialog.inputVisible?t("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:e.handleInputConfirm},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm.apply(null,arguments)}},model:{value:e.editDialog.inputValue,callback:function(t){e.$set(e.editDialog,"inputValue",t)},expression:"editDialog.inputValue"}}):t("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:e.showInput}},[e._v("+ 添加标签")])],2)],1)],1):e._e(),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editDialog.visible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("保存")])],1)]),t("el-dialog",{attrs:{title:"删除确认",visible:e.deleteDialog.visible,width:"30%"},on:{"update:visible":function(t){return e.$set(e.deleteDialog,"visible",t)}}},[t("p",[e._v("确定要删除"+e._s(e.deleteDialog.isBatch?"选中的 "+e.selectedPaintings.length+" 个":"这个")+"作品吗？此操作不可撤销。")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.deleteDialog.visible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:e.confirmDeleteAction}},[e._v("删除")])],1)])],1)},_i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"tab-header"},[t("h2",{staticClass:"tab-title"},[e._v("我的AI绘画作品")]),t("p",{staticClass:"tab-description"},[e._v("管理和展示您创建的所有AI生成画作")])])}],wi=(s(3579),{name:"GalleryTab",data(){return{searchQuery:"",modelFilter:"",timeFilter:"",sortOption:"newest",currentPage:1,pageSize:12,modelOptions:[{value:"sdxl",label:"Stable Diffusion XL"},{value:"sd1.5",label:"Stable Diffusion 1.5"},{value:"dall-e",label:"DALL-E 3"},{value:"midjourney",label:"Midjourney"}],timeOptions:[{value:"today",label:"今天"},{value:"week",label:"本周"},{value:"month",label:"本月"},{value:"year",label:"今年"}],sortOptions:[{value:"newest",label:"最新创建"},{value:"oldest",label:"最早创建"},{value:"name_asc",label:"名称 A-Z"},{value:"name_desc",label:"名称 Z-A"}],editDialog:{visible:!1,painting:null,tags:[],inputVisible:!1,inputValue:""},deleteDialog:{visible:!1,painting:null,isBatch:!1},selectedPaintings:[],paintings:Array.from({length:24},((e,t)=>({id:t+1,title:t%3===0?`幻想风景 ${t+1}`:t%3===1?`角色设计 ${t+1}`:"",prompt:`美丽的${t%2===0?"山川":"海洋"}风景, 高清细节, 震撼壮丽, 8k分辨率`,model:t%4===0?"Stable Diffusion XL":t%4===1?"Stable Diffusion 1.5":t%4===2?"DALL-E 3":"Midjourney",created:new Date(Date.now()-30*Math.random()*24*60*60*1e3),width:1024,height:1024,tags:this.getRandomTags(),imageUrl:`https://picsum.photos/seed/${t+100}/300/300`,sampler:"Euler a",steps:30,cfg:7.5,seed:Math.floor(1e9*Math.random())})))}},computed:{filteredPaintings(){let e=[...this.paintings];if(this.searchQuery){const t=this.searchQuery.toLowerCase();e=e.filter((e=>e.title&&e.title.toLowerCase().includes(t)||e.prompt&&e.prompt.toLowerCase().includes(t)||e.tags&&e.tags.some((e=>e.toLowerCase().includes(t)))))}if(this.modelFilter){const t=this.modelFilter.toLowerCase();e=e.filter((e=>e.model.toLowerCase().includes(t)))}if(this.timeFilter){const t=new Date;let s=new Date;switch(this.timeFilter){case"today":s.setHours(0,0,0,0);break;case"week":s.setDate(t.getDate()-7);break;case"month":s.setMonth(t.getMonth()-1);break;case"year":s.setFullYear(t.getFullYear()-1);break}e=e.filter((e=>new Date(e.created)>=s))}switch(this.sortOption){case"newest":e.sort(((e,t)=>new Date(t.created)-new Date(e.created)));break;case"oldest":e.sort(((e,t)=>new Date(e.created)-new Date(t.created)));break;case"name_asc":e.sort(((e,t)=>(e.title||"").localeCompare(t.title||"")));break;case"name_desc":e.sort(((e,t)=>(t.title||"").localeCompare(e.title||"")));break}const t=(this.currentPage-1)*this.pageSize;return e.slice(t,t+this.pageSize)},totalPaintings(){return this.paintings.length},hasFilters(){return this.searchQuery||this.modelFilter||this.timeFilter}},methods:{formatDate(e){if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`},getRandomTags(){const e=["风景","人物","抽象","城市","自然","动物","建筑","静物","梦幻","现代","复古","科幻"],t=Math.floor(3*Math.random()),s=[...e].sort((()=>.5-Math.random()));return s.slice(0,t)},applyFilters(){this.currentPage=1},resetSearch(){this.searchQuery="",this.applyFilters()},resetFilters(){this.searchQuery="",this.modelFilter="",this.timeFilter="",this.sortOption="newest",this.currentPage=1},handlePageChange(e){this.currentPage=e,window.scrollTo({top:0,behavior:"smooth"})},filterByTag(e){this.searchQuery=e,this.applyFilters()},viewPaintingDetail(e){this.$message.info(`查看画作详情: ${e}`)},downloadImage(e){this.$message.success(`下载画作: ${e.id}`)},editPrompt(e){this.editDialog.painting=JSON.parse(JSON.stringify(e)),this.editDialog.tags=e.tags?[...e.tags]:[],this.editDialog.visible=!0},saveEdit(){if(!this.editDialog.painting)return;const e=this.paintings.findIndex((e=>e.id===this.editDialog.painting.id));-1!==e&&(this.editDialog.painting.tags=[...this.editDialog.tags],this.paintings[e]={...this.editDialog.painting},this.$message.success("画作信息已更新")),this.editDialog.visible=!1},handleTagClose(e){this.editDialog.tags.splice(this.editDialog.tags.indexOf(e),1)},showInput(){this.editDialog.inputVisible=!0,this.$nextTick((()=>{this.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm(){const e=this.editDialog.inputValue;e&&!this.editDialog.tags.includes(e)&&this.editDialog.tags.push(e),this.editDialog.inputVisible=!1,this.editDialog.inputValue=""},confirmDelete(e){this.deleteDialog.painting=e,this.deleteDialog.isBatch=!1,this.deleteDialog.visible=!0},batchDelete(){0!==this.selectedPaintings.length&&(this.deleteDialog.isBatch=!0,this.deleteDialog.visible=!0)},confirmDeleteAction(){if(this.deleteDialog.isBatch){const e=this.selectedPaintings.map((e=>e.id));this.paintings=this.paintings.filter((t=>!e.includes(t.id))),this.selectedPaintings=[],this.$message.success(`已删除 ${e.length} 个画作`)}else this.deleteDialog.painting&&(this.paintings=this.paintings.filter((e=>e.id!==this.deleteDialog.painting.id)),this.$message.success("画作已删除"));this.deleteDialog.visible=!1},toggleSelection(e){const t=this.selectedPaintings.findIndex((t=>t.id===e.id));-1!==t?this.selectedPaintings.splice(t,1):this.selectedPaintings.push(e)},clearSelection(){this.selectedPaintings=[]},batchDownload(){0!==this.selectedPaintings.length&&this.$message.success(`开始下载 ${this.selectedPaintings.length} 个画作`)},goToCreate(){this.$emit("changeTab","text2img")}}}),yi=wi,ki=(0,Fs.A)(yi,Ci,_i,!1,null,"244a1776",null),xi=ki.exports,Si=function(){var e=this,t=e._self._c;return t("div",{staticClass:"inpaint-tab"},[e._m(0),t("div",{staticClass:"tab-content"},[t("div",{staticClass:"left-section"},[t("div",{staticClass:"upload-section"},[t("h3",[e._v("上传图像")]),t("image-uploader",{on:{change:e.handleImageChange},model:{value:e.sourceImage,callback:function(t){e.sourceImage=t},expression:"sourceImage"}}),e.sourceImage?e._e():t("div",{staticClass:"image-tips"},[t("p",[e._v("上传需要编辑的图像")]),t("p",[e._v("支持PNG、JPG等格式")])])],1),e.sourceImage?t("div",{staticClass:"tools-section"},[t("h3",[e._v("编辑工具")]),t("div",{staticClass:"tool-buttons"},[t("el-button-group",[t("el-button",{attrs:{type:"brush"===e.currentTool?"primary":"default",size:"small"},on:{click:function(t){return e.setTool("brush")}}},[t("i",{staticClass:"el-icon-brush"}),e._v(" 画笔 ")]),t("el-button",{attrs:{type:"eraser"===e.currentTool?"primary":"default",size:"small"},on:{click:function(t){return e.setTool("eraser")}}},[t("i",{staticClass:"el-icon-delete"}),e._v(" 橡皮擦 ")]),t("el-button",{attrs:{type:"fill"===e.currentTool?"primary":"default",size:"small"},on:{click:function(t){return e.setTool("fill")}}},[t("i",{staticClass:"el-icon-magic-stick"}),e._v(" 填充 ")])],1)],1),t("div",{staticClass:"brush-settings"},[t("div",{staticClass:"setting-item"},[t("label",[e._v("画笔大小")]),t("div",{staticClass:"slider-with-value"},[t("el-slider",{attrs:{min:1,max:50,step:1},model:{value:e.brushSize,callback:function(t){e.brushSize=t},expression:"brushSize"}}),t("span",{staticClass:"value-display"},[e._v(e._s(e.brushSize)+"px")])],1)]),t("div",{staticClass:"setting-item"},[t("label",[e._v("模式")]),t("el-select",{attrs:{placeholder:"选择模式"},model:{value:e.inpaintMode,callback:function(t){e.inpaintMode=t},expression:"inpaintMode"}},[t("el-option",{attrs:{label:"移除",value:"remove"}}),t("el-option",{attrs:{label:"替换",value:"replace"}}),t("el-option",{attrs:{label:"区域重绘",value:"redraw"}})],1)],1)])]):e._e()]),t("div",{staticClass:"right-section"},[t("div",{staticClass:"inpaint-settings"},[t("h3",[e._v("Inpaint设置")]),"replace"===e.inpaintMode||"redraw"===e.inpaintMode?[t("div",{staticClass:"prompt-section"},[t("h4",[e._v("提示词")]),t("el-input",{attrs:{type:"textarea",rows:4,placeholder:"描述想要替换的内容...",maxlength:500,"show-word-limit":""},model:{value:e.prompt,callback:function(t){e.prompt=t},expression:"prompt"}}),t("h4",[e._v("负面提示词")]),t("el-input",{attrs:{type:"textarea",rows:2,placeholder:"描述不希望出现的内容...",maxlength:200,"show-word-limit":""},model:{value:e.negativePrompt,callback:function(t){e.negativePrompt=t},expression:"negativePrompt"}})],1)]:e._e(),t("div",{staticClass:"setting-item"},[t("label",[e._v("采样方法")]),t("el-select",{attrs:{placeholder:"选择采样方法"},model:{value:e.sampler,callback:function(t){e.sampler=t},expression:"sampler"}},[t("el-option",{attrs:{label:"Euler a",value:"euler_a"}}),t("el-option",{attrs:{label:"DPM++ 2M Karras",value:"dpm_2m_karras"}}),t("el-option",{attrs:{label:"DPM++ SDE Karras",value:"dpm_sde_karras"}})],1)],1),t("div",{staticClass:"setting-item"},[t("label",[e._v("去噪强度")]),t("div",{staticClass:"slider-with-value"},[t("el-slider",{attrs:{min:0,max:1,step:.01},model:{value:e.denoiseStrength,callback:function(t){e.denoiseStrength=t},expression:"denoiseStrength"}}),t("span",{staticClass:"value-display"},[e._v(e._s(e.denoiseStrength.toFixed(2)))])],1)]),t("div",{staticClass:"setting-item"},[t("label",[e._v("迭代步数")]),t("el-input-number",{attrs:{min:1,max:150,step:1},model:{value:e.steps,callback:function(t){e.steps=t},expression:"steps"}})],1),t("div",{staticClass:"checkbox-option"},[t("el-checkbox",{model:{value:e.useInpaintModel,callback:function(t){e.useInpaintModel=t},expression:"useInpaintModel"}},[e._v("使用专用修复模型")]),t("el-tooltip",{attrs:{content:"使用专门为修复任务训练的模型",placement:"right"}},[t("i",{staticClass:"el-icon-question"})])],1)],2),t("div",{staticClass:"generate-button-wrapper"},[t("generate-button",{attrs:{loading:e.isProcessing,disabled:!e.canProcess,"credit-count":e.creditCount,"show-progress":!0,"progress-value":e.processingProgress},on:{generate:e.processImage,"open-vip":e.openVipDialog}})],1)])]),e.hasResults?t("div",{staticClass:"results-section"},[t("div",{staticClass:"results-header"},[t("h3",[e._v("处理结果")]),t("div",{staticClass:"results-actions"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.saveImage}},[e._v("保存图像")]),t("el-button",{attrs:{size:"small"},on:{click:e.clearResults}},[e._v("清除结果")])],1)]),t("div",{staticClass:"comparison-view"},[t("div",{staticClass:"comparison-item"},[t("div",{staticClass:"comparison-title"},[e._v("原始图像")]),t("div",{staticClass:"image-container"},[e.sourceImage?t("div",{staticClass:"image-placeholder source-preview"},[e._v("原图预览")]):t("div",{staticClass:"image-placeholder"},[e._v("无图像")])])]),e._m(1),t("div",{staticClass:"comparison-item"},[t("div",{staticClass:"comparison-title"},[e._v("修复后图像")]),t("div",{staticClass:"image-container"},[e.inpaintedImage?t("div",{staticClass:"image-placeholder inpainted-preview",style:{backgroundColor:e.resultColor}},[e._v("修复后预览")]):t("div",{staticClass:"image-placeholder"},[e._v("无图像")])])])]),t("div",{staticClass:"result-actions"},[t("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:e.downloadImage}},[e._v("下载图像")]),t("el-button",{attrs:{type:"success",icon:"el-icon-star-off"},on:{click:e.addToFavorites}},[e._v("添加到收藏")]),t("el-button",{attrs:{type:"info",icon:"el-icon-edit"},on:{click:e.continueEditing}},[e._v("继续编辑")])],1)]):e._e(),t("el-dialog",{attrs:{title:"正在处理图像",visible:e.loadingDialog,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,width:"30%"},on:{"update:visible":function(t){e.loadingDialog=t}}},[t("div",{staticClass:"loading-dialog-content"},[t("el-progress",{attrs:{percentage:e.processingProgress,format:e.progressFormat}}),t("p",[e._v("正在为您修复图像，请稍等...")])],1)])],1)},Pi=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"tab-header"},[t("h2",{staticClass:"tab-title"},[e._v("Inpaint Anything")]),t("p",{staticClass:"tab-description"},[e._v("智能移除或替换图像中的物体，通过AI技术进行无缝修复")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"comparison-arrow"},[t("i",{staticClass:"el-icon-arrow-right"})])}],Ii={name:"InpaintTab",components:{ImageUploader:si,GenerateButton:Ls},data(){return{sourceImage:null,inpaintedImage:null,resultColor:"#5f8bff",currentTool:"brush",brushSize:20,inpaintMode:"remove",prompt:"",negativePrompt:"",sampler:"euler_a",denoiseStrength:.75,steps:20,useInpaintModel:!0,isProcessing:!1,loadingDialog:!1,processingProgress:0,hasResults:!1}},computed:{canProcess(){return null!==this.sourceImage},creditCount(){let e=5;return"remove"!==this.inpaintMode&&(e+=2),this.useInpaintModel&&(e+=1),this.steps>30&&(e+=2),e}},methods:{handleImageChange(e){e&&(this.inpaintedImage=null,this.hasResults=!1)},setTool(e){this.currentTool=e},progressFormat(e){return e+"%"},async processImage(){if(this.canProcess){this.isProcessing=!0,this.loadingDialog=!0,this.processingProgress=0;try{await g((e=>{this.processingProgress=e}),4e3),this.inpaintedImage=!0,this.hasResults=!0,this.resultColor=u(60,70),this.$message.success("图像修复完成")}catch(e){this.$message.error("图像处理失败"),console.error("处理错误:",e)}finally{this.isProcessing=!1,this.loadingDialog=!1}}},saveImage(){this.$message.success("图像已保存到您的作品集")},clearResults(){this.inpaintedImage=null,this.hasResults=!1},downloadImage(){this.$message.success("图像已下载")},addToFavorites(){this.$message.success("已添加到收藏")},continueEditing(){this.$message.info("进入图像编辑模式")},openVipDialog(){this.$message.info("开通VIP会员功能开发中")}}},Ti=Ii,Di=(0,Fs.A)(Ti,Si,Pi,!1,null,"6dfe3b4c",null),Ri=Di.exports,Ei=function(){var e=this,t=e._self._c;return t("div",{staticClass:"image-info-tab"},[e._m(0),t("div",{staticClass:"tab-content"},[t("div",{staticClass:"left-section"},[t("div",{staticClass:"upload-section"},[t("h3",[e._v("上传PNG图像")]),t("image-uploader",{attrs:{accept:".png"},on:{change:e.handleImageChange},model:{value:e.sourceImage,callback:function(t){e.sourceImage=t},expression:"sourceImage"}}),e.sourceImage?e._e():t("div",{staticClass:"image-tips"},[t("p",[e._v("上传需要查看信息的PNG图像")]),t("p",[e._v("仅支持含有元数据的PNG格式图像")]),t("p",[e._v("通常由AI绘画工具生成的图像包含生成参数")])])],1),e.sourceImage?t("div",{staticClass:"image-preview"},[t("h3",[e._v("图像预览")]),e._m(1),t("div",{staticClass:"image-basic-info"},[t("div",{staticClass:"info-item"},[t("span",{staticClass:"info-label"},[e._v("图像尺寸:")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.imageInfo.width||512)+" x "+e._s(e.imageInfo.height||512))])]),t("div",{staticClass:"info-item"},[t("span",{staticClass:"info-label"},[e._v("文件大小:")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.imageInfo.fileSize||"1.2 MB"))])]),t("div",{staticClass:"info-item"},[t("span",{staticClass:"info-label"},[e._v("创建日期:")]),t("span",{staticClass:"info-value"},[e._v(e._s(e.imageInfo.createDate||"2023-11-24 15:30:45"))])])])]):e._e()]),t("div",{staticClass:"right-section"},[t("div",{staticClass:"metadata-section"},[t("div",{staticClass:"section-header"},[t("h3",[e._v("生成参数")]),e.hasMetadata?t("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-copy-document"},on:{click:e.copyMetadata}},[e._v(" 复制全部 ")]):e._e()],1),e.hasMetadata?t("div",{staticClass:"metadata-content"},[t("div",{staticClass:"metadata-item"},[e._m(2),t("div",{staticClass:"item-content"},[t("div",{staticClass:"prompt-text"},[e._v(e._s(e.metadataInfo.prompt))])])]),t("div",{staticClass:"metadata-item"},[e._m(3),t("div",{staticClass:"item-content"},[t("div",{staticClass:"prompt-text"},[e._v(e._s(e.metadataInfo.negativePrompt))])])]),t("div",{staticClass:"parameters-grid"},[t("div",{staticClass:"parameter-item"},[t("span",{staticClass:"parameter-label"},[e._v("模型:")]),t("span",{staticClass:"parameter-value"},[e._v(e._s(e.metadataInfo.model))])]),t("div",{staticClass:"parameter-item"},[t("span",{staticClass:"parameter-label"},[e._v("采样器:")]),t("span",{staticClass:"parameter-value"},[e._v(e._s(e.metadataInfo.sampler))])]),t("div",{staticClass:"parameter-item"},[t("span",{staticClass:"parameter-label"},[e._v("采样步数:")]),t("span",{staticClass:"parameter-value"},[e._v(e._s(e.metadataInfo.steps))])]),t("div",{staticClass:"parameter-item"},[t("span",{staticClass:"parameter-label"},[e._v("CFG Scale:")]),t("span",{staticClass:"parameter-value"},[e._v(e._s(e.metadataInfo.cfgScale))])]),t("div",{staticClass:"parameter-item"},[t("span",{staticClass:"parameter-label"},[e._v("种子:")]),t("span",{staticClass:"parameter-value"},[e._v(e._s(e.metadataInfo.seed))])]),t("div",{staticClass:"parameter-item"},[t("span",{staticClass:"parameter-label"},[e._v("尺寸:")]),t("span",{staticClass:"parameter-value"},[e._v(e._s(e.metadataInfo.width)+"x"+e._s(e.metadataInfo.height))])]),t("div",{staticClass:"parameter-item"},[t("span",{staticClass:"parameter-label"},[e._v("批次大小:")]),t("span",{staticClass:"parameter-value"},[e._v(e._s(e.metadataInfo.batchSize))])]),t("div",{staticClass:"parameter-item"},[t("span",{staticClass:"parameter-label"},[e._v("模型类型:")]),t("span",{staticClass:"parameter-value"},[e._v(e._s(e.metadataInfo.modelType))])])])]):t("div",{staticClass:"no-data-placeholder"},[t("i",{staticClass:"el-icon-info"}),t("p",[e._v("上传图片后查看元数据信息")])])]),e.hasMetadata?t("div",{staticClass:"action-buttons"},[t("el-button",{attrs:{type:"primary"},on:{click:e.useInTextToImage}},[e._v("在文生图中使用")]),t("el-button",{on:{click:e.downloadInfoAsText}},[e._v("下载信息")])],1):e._e()])])])},$i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"tab-header"},[t("h2",{staticClass:"tab-title"},[e._v("PNG图片信息")]),t("p",{staticClass:"tab-description"},[e._v("查看和提取PNG图片中的生成参数和Stable Diffusion元数据")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"preview-container"},[t("div",{staticClass:"preview-placeholder"},[e._v(" 图像预览 ")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"item-header"},[t("span",{staticClass:"item-title"},[e._v("提示词 (Prompt)")])])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"item-header"},[t("span",{staticClass:"item-title"},[e._v("反向提示词 (Negative Prompt)")])])}],zi=(s(4603),s(7566),s(8721),{name:"ImageInfoTab",components:{ImageUploader:si},data(){return{sourceImage:null,imageInfo:{width:null,height:null,fileSize:null,createDate:null},metadataInfo:{prompt:"高质量女孩肖像，长发，蓝眼睛，微笑，阳光下，户外，精致细节，超写实，高质量，8k分辨率",negativePrompt:"低质量，模糊，扭曲，不自然的姿势，糟糕的解剖结构，变形的手，不自然的皮肤，低分辨率",model:"realisticVisionV5_v51VAE",sampler:"DPM++ 2M Karras",steps:30,cfgScale:7,seed:3857502736,width:512,height:768,batchSize:1,modelType:"Stable Diffusion"}}},computed:{hasMetadata(){return null!==this.sourceImage}},methods:{handleImageChange(e){e?this.parseImageMetadata():this.resetData()},parseImageMetadata(){this.imageInfo={width:512,height:768,fileSize:"1.2 MB",createDate:(new Date).toLocaleString()}},resetData(){this.imageInfo={width:null,height:null,fileSize:null,createDate:null}},copyMetadata(){const e=this.formatMetadataAsText();navigator.clipboard.writeText(e).then((()=>{this.$message.success("元数据已复制到剪贴板")})).catch((()=>{this.$message.error("复制失败")}))},formatMetadataAsText(){const e=this.metadataInfo;return`Prompt: ${e.prompt}\n\nNegative Prompt: ${e.negativePrompt}\n\nModel: ${e.model}\nSampler: ${e.sampler}\nSteps: ${e.steps}\nCFG Scale: ${e.cfgScale}\nSeed: ${e.seed}\nSize: ${e.width}x${e.height}\nBatch Size: ${e.batchSize}\nModel Type: ${e.modelType}`},useInTextToImage(){this.$message.success("参数已应用到文生图"),this.$emit("use-in-text2img",this.metadataInfo)},downloadInfoAsText(){const e=this.formatMetadataAsText(),t=new Blob([e],{type:"text/plain"}),s=URL.createObjectURL(t),i=document.createElement("a");i.href=s,i.download="image_metadata.txt",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(s),this.$message.success("元数据已下载")}}}),Oi=zi,Ai=(0,Fs.A)(Oi,Ei,$i,!1,null,"73169fab",null),Fi=Ai.exports,Ui=function(){var e=this,t=e._self._c;return t("div",{staticClass:"tagger-tab"},[e._m(0),t("div",{staticClass:"tab-content"},[t("div",{staticClass:"left-section"},[t("div",{staticClass:"upload-section"},[t("h3",[e._v("上传图像")]),t("image-uploader",{on:{change:e.handleImageChange},model:{value:e.sourceImage,callback:function(t){e.sourceImage=t},expression:"sourceImage"}}),e.sourceImage?e._e():t("div",{staticClass:"image-tips"},[t("p",[e._v("上传需要提取标签的图像")]),t("p",[e._v("支持PNG、JPG等格式")])])],1)]),t("div",{staticClass:"right-section"},[t("div",{staticClass:"tagger-settings"},[t("h3",[e._v("标签提取设置")]),t("div",{staticClass:"setting-item"},[t("label",[e._v("标签模型")]),t("el-select",{attrs:{placeholder:"选择标签模型"},model:{value:e.taggerModel,callback:function(t){e.taggerModel=t},expression:"taggerModel"}},[t("el-option",{attrs:{label:"WD 1.4 Tagger",value:"wd14"}}),t("el-option",{attrs:{label:"DeepDanbooru",value:"deepdanbooru"}}),t("el-option",{attrs:{label:"CLIP",value:"clip"}})],1)],1),t("div",{staticClass:"setting-item"},[t("label",[e._v("标签语言")]),t("el-select",{attrs:{placeholder:"选择标签语言"},model:{value:e.tagLanguage,callback:function(t){e.tagLanguage=t},expression:"tagLanguage"}},[t("el-option",{attrs:{label:"中文",value:"zh"}}),t("el-option",{attrs:{label:"英文",value:"en"}}),t("el-option",{attrs:{label:"日文",value:"jp"}})],1)],1),t("div",{staticClass:"setting-item"},[t("label",[e._v("置信度阈值")]),t("div",{staticClass:"slider-with-value"},[t("el-slider",{attrs:{min:0,max:1,step:.01},model:{value:e.confidenceThreshold,callback:function(t){e.confidenceThreshold=t},expression:"confidenceThreshold"}}),t("span",{staticClass:"value-display"},[e._v(e._s(e.confidenceThreshold.toFixed(2)))])],1)]),t("div",{staticClass:"checkbox-options"},[t("div",{staticClass:"checkbox-option"},[t("el-checkbox",{model:{value:e.includeCharacter,callback:function(t){e.includeCharacter=t},expression:"includeCharacter"}},[e._v("包含角色标签")])],1),t("div",{staticClass:"checkbox-option"},[t("el-checkbox",{model:{value:e.includeGeneral,callback:function(t){e.includeGeneral=t},expression:"includeGeneral"}},[e._v("包含一般标签")])],1),t("div",{staticClass:"checkbox-option"},[t("el-checkbox",{model:{value:e.excludeNSFW,callback:function(t){e.excludeNSFW=t},expression:"excludeNSFW"}},[e._v("排除NSFW标签")])],1),t("div",{staticClass:"checkbox-option"},[t("el-checkbox",{model:{value:e.sortByConfidence,callback:function(t){e.sortByConfidence=t},expression:"sortByConfidence"}},[e._v("按置信度排序")])],1)])]),t("div",{staticClass:"generate-button-wrapper"},[t("el-button",{attrs:{type:"primary",size:"medium",loading:e.isProcessing,disabled:!e.canProcess},on:{click:e.extractTags}},[e._v(" 提取标签 ")])],1)]),e.hasTags?t("div",{staticClass:"results-section"},[t("div",{staticClass:"results-header"},[t("h3",[e._v("提取结果")]),t("div",{staticClass:"results-actions"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.copyAllTags}},[e._v("复制所有")]),t("el-button",{attrs:{size:"small"},on:{click:e.clearResults}},[e._v("清除结果")])],1)]),t("div",{staticClass:"tags-container"},[t("div",{staticClass:"tags-list"},e._l(e.extractedTags,(function(s,i){return t("div",{key:i,staticClass:"tag-item"},[t("span",{staticClass:"tag-name"},[e._v(e._s(s.name))]),t("div",{staticClass:"tag-confidence-bar",style:{width:100*s.confidence+"%"}}),t("span",{staticClass:"tag-confidence"},[e._v(e._s((100*s.confidence).toFixed(1))+"%")])])})),0),t("div",{staticClass:"formatted-prompt"},[t("h4",[e._v("格式化提示词")]),t("el-input",{attrs:{type:"textarea",rows:6,readonly:""},model:{value:e.formattedPrompt,callback:function(t){e.formattedPrompt=t},expression:"formattedPrompt"}}),t("div",{staticClass:"prompt-actions"},[t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.copyPrompt}},[e._v("复制提示词")]),t("el-button",{attrs:{size:"small"},on:{click:e.useInTextToImage}},[e._v("在文生图中使用")])],1)],1)])]):e._e()]),t("el-dialog",{attrs:{title:"正在提取标签",visible:e.loadingDialog,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,width:"30%"},on:{"update:visible":function(t){e.loadingDialog=t}}},[t("div",{staticClass:"loading-dialog-content"},[t("el-progress",{attrs:{percentage:e.processingProgress,format:e.progressFormat}}),t("p",[e._v("正在分析图像并提取标签，请稍等...")])],1)])],1)},Li=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"tab-header"},[t("h2",{staticClass:"tab-title"},[e._v("WD1.4 标签器")]),t("p",{staticClass:"tab-description"},[e._v("上传图片，自动提取适用于AI绘画的标签和提示词")])])}],Mi={name:"TaggerTab",components:{ImageUploader:si},data(){return{sourceImage:null,taggerModel:"wd14",tagLanguage:"zh",confidenceThreshold:.35,includeCharacter:!0,includeGeneral:!0,excludeNSFW:!0,sortByConfidence:!0,isProcessing:!1,loadingDialog:!1,processingProgress:0,extractedTags:[],formattedPrompt:""}},computed:{canProcess(){return null!==this.sourceImage},hasTags(){return this.extractedTags.length>0}},methods:{handleImageChange(e){e&&(this.extractedTags=[],this.formattedPrompt="")},progressFormat(e){return e+"%"},async extractTags(){if(this.canProcess){this.isProcessing=!0,this.loadingDialog=!0,this.processingProgress=0;try{await g((e=>{this.processingProgress=e}),3e3),this.generateMockTags(),this.$message.success("标签提取完成")}catch(e){this.$message.error("标签提取失败"),console.error("处理错误:",e)}finally{this.isProcessing=!1,this.loadingDialog=!1}}},generateMockTags(){const e=[{name:"女孩",confidence:.99,type:"character"},{name:"微笑",confidence:.95,type:"general"},{name:"长发",confidence:.93,type:"general"},{name:"蓝眼睛",confidence:.89,type:"general"},{name:"连衣裙",confidence:.85,type:"general"},{name:"花",confidence:.82,type:"general"},{name:"户外",confidence:.78,type:"general"},{name:"阳光",confidence:.76,type:"general"},{name:"公园",confidence:.68,type:"general"},{name:"白色裙子",confidence:.65,type:"general"},{name:"天空",confidence:.62,type:"general"},{name:"树",confidence:.59,type:"general"},{name:"草地",confidence:.55,type:"general"},{name:"云",confidence:.48,type:"general"},{name:"蝴蝶",confidence:.42,type:"general"},{name:"手持花束",confidence:.39,type:"general"},{name:"春天",confidence:.36,type:"general"}];this.extractedTags=e.filter((e=>!(e.confidence<this.confidenceThreshold)&&(!(!this.includeCharacter&&"character"===e.type)&&!(!this.includeGeneral&&"general"===e.type)))),this.sortByConfidence&&this.extractedTags.sort(((e,t)=>t.confidence-e.confidence)),this.formattedPrompt=this.extractedTags.map((e=>e.name+("en"===this.tagLanguage?" ":"，"))).join("")},copyAllTags(){const e=this.extractedTags.map((e=>e.name)).join("，");navigator.clipboard.writeText(e).then((()=>{this.$message.success("已复制所有标签")})).catch((()=>{this.$message.error("复制失败")}))},copyPrompt(){navigator.clipboard.writeText(this.formattedPrompt).then((()=>{this.$message.success("已复制提示词")})).catch((()=>{this.$message.error("复制失败")}))},useInTextToImage(){this.$message.success("已添加到文生图提示词"),this.$emit("use-in-text2img",this.formattedPrompt)},clearResults(){this.extractedTags=[],this.formattedPrompt=""}}},Ni=Mi,Bi=(0,Fs.A)(Ni,Ui,Li,!1,null,"be81c1f6",null),Vi=Bi.exports,ji={name:"CreatePaintingView",components:{MainLayout:o.A,TextToImageTab:Ks,ImageToImageTab:oi,PostProcessingTab:pi,UpscaleTab:bi,GalleryTab:xi,InpaintTab:Ri,ImageInfoTab:Fi,TaggerTab:Vi},data(){return{activeTab:"text2img",isLoggedIn:!0,isVip:!1,vipExpires:null,userCredits:50,showFeatureTip:!0,creditsDialog:{visible:!1,selectedPackage:null},creditPackages:[{id:1,amount:100,price:10,bonus:0},{id:2,amount:500,price:45,bonus:50},{id:3,amount:1e3,price:80,bonus:200},{id:4,amount:2e3,price:150,bonus:500}]}},computed:{vipExpiresText(){if(!this.vipExpires)return"";const e=new Date(this.vipExpires),t=new Date,s=Math.ceil((e-t)/864e5);return s>0?`剩余${s}天`:"已过期"}},created(){this.checkLoginStatus()},methods:{checkLoginStatus(){this.isLoggedIn||this.$router.push("/login")},handleTabChange(){console.log("当前标签页:",this.activeTab)},changeTab(e){this.activeTab=e},closeFeatureTip(){this.showFeatureTip=!1},openVipOptions(){this.$refs.text2imgTab&&"function"===typeof this.$refs.text2imgTab.openVipOptions&&this.$refs.text2imgTab.openVipOptions()},openBuyCredits(){this.creditsDialog.visible=!0},selectCreditPackage(e){this.creditsDialog.selectedPackage=e},confirmCreditPurchase(){if(!this.creditsDialog.selectedPackage)return;const e=this.creditsDialog.selectedPackage;this.userCredits+=e.amount+(e.bonus||0),this.$message.success(`您已成功购买${e.amount}积分${e.bonus?"，赠送"+e.bonus+"积分":""}！`),this.creditsDialog.visible=!1,this.creditsDialog.selectedPackage=null,this.syncCreditsToComponents()},syncCreditsToComponents(){const e=["text2imgTab","img2imgTab","postprocessingTab"];e.forEach((e=>{this.$refs[e]&&"function"===typeof this.$refs[e].updateUserTokens&&this.$refs[e].updateUserTokens(this.userCredits)}))}}},Gi=ji,qi=(0,Fs.A)(Gi,a,n,!1,null,"7a087d7e",null),Hi=qi.exports}}]);
//# sourceMappingURL=237.3a1a0927.js.map